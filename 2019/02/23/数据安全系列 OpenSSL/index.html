<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 数据安全系列 OpenSSL · 花田半亩</title><meta name="description" content="数据安全系列 OpenSSL - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="花田半亩" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="https://github.com/flowerField" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">数据安全系列 OpenSSL</h1><div class="post-info">Feb 23, 2019<span class="post-count"></span> ✧ 字数统计:3.3k(字) &nbsp;&nbsp; ♨︎ 阅读时长:15(分钟)</div><div class="post-content"><blockquote>
<p>本文对密码学中常用的底层库OpenSSL进行简单说明，包括基本介绍、简单使用等内容。</p>
</blockquote>
<div class='titleX'>**简单介绍**</div>

<p>**<a target="_blank" rel="noopener" href="https://www.openssl.org/">OpenSSL</a> **是密码学中一个流行的底层密码库，也是SSL和TLS最常见的开源实现。</p>
<div class='tip'>
<div>**`SSL`**全称为`Secure  Sockets   Layer`，**安全套接层协议**( 对网络连接进行加密处理 )。</div>
<div>**`TLS`**全称为`Transport Layer Security`，**安全传输层协议**( 由记录协议和握手协议组成 )。</div>
</div>

<p>SSL协议由<code>Netscape</code>(网景)公司开发，因为应用广泛，到了1999年SSL已经成为互联网上的事实标准。同年，<code>IETF把SSL标准化后改名为TLS，它建立在SSL 3.0协议规范上，是SSL的后续版本</code>。 TLS 和 SSL，两者差别极小，可以简单看做是同一个东西的两个不同阶段。</p>
<p>**<a target="_blank" rel="noopener" href="https://www.openssl.org/">OpenSSL</a> **是由一些志愿者合作开发的开源工具库，其目标是开发一个强壮的、具有完备功能的商业级工具集，以实现SSL 和 TLS协议以及一个全功能的通用加密库。OpenSSL主要以C语言实现，目前最新稳定版本为2018年9月11日发布的<code>1.1.1版本</code>。</p>
<p><span style='border:0.2px solid #000;padding:5px 20px;background:#f8f8f0;color:#555'>** OpenSSL **的主要组成</span></p>
<div>
❏  <div class='liYY'>**openssl**</div>  多用途的命令行工具。
❏  <div class='liYY'>**libcrypto**</div> 常用加密算法库。
❏  <div class='liYY'>**libssl**</div>   实现了SSL及TLS的加密模块应用库。
</div>

<p><strong><a target="_blank" rel="noopener" href="https://www.openssl.org/">OpenSSL</a> <strong>支持许多不同的加密算法：其中包括但不限于</strong>单向散列函数</strong>的 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/MD5">MD5</a>、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/MD4">MD4</a>、MD2、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/SHA-1">SHA-1</a>、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/SHA-2">SHA-2</a>、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/SHA-3">SHA-3</a>、RIPEMD-160、MDC-2、GOST R 34.11-94、BLAKE2、Whirlpool、SM3等算法，<strong>对称加密</strong>有 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86">AES</a>、Blowfish、Camellia、Chacha20、Poly1305、SEED、CAST-128、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%B3%87%E6%96%99%E5%8A%A0%E5%AF%86%E6%A8%99%E6%BA%96">DES</a>、IDEA、RC2、RC4、<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/RC5">RC5</a>、SM4、TDES、GOST 28147-89等算法，以及<strong>非对称加密</strong>的 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/RSA%E5%8A%A0%E5%AF%86%E6%BC%94%E7%AE%97%E6%B3%95">RSA</a>、DSA、迪菲-赫尔曼密钥交换、椭圆曲线、SM2、X25519、Ed25519、X448、Ed448、GOST R 34.10-2001等算法。</p>
<p><strong>参考资料</strong> </p>
<p><a target="_blank" rel="noopener" href="https://www.openssl.org/">OpenSSL官网</a><br><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/OpenSSL">OpenSSL 维基百科</a><br><a target="_blank" rel="noopener" href="https://github.com/openssl">OpenSSL GitHub组织</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/eshizhan/p/4988105.html">OpenSSL Command-Line HOWTO</a><br><a target="_blank" rel="noopener" href="https://oomake.com/download/openssl">OpenSSL 版本下载地址①</a> &nbsp;<a target="_blank" rel="noopener" href="https://www.openssl.org/source/">OpenSSL 版本下载地址②</a></p>
<div class='titleX'>**opsnssl 命令行简单说明**</div>

<p><strong><a target="_blank" rel="noopener" href="https://www.openssl.org/">OpenSSL</a> 的安装</strong></p>
<p>通常，很多操作系统都会默认安装OpenSSL 工具，我们可以通过在终端中输入<code>openssl version</code>命令来查看和进行验证。</p>
<p class='tip'>早些年，Mac OSX默认自带安装 OpenSSL库，但是因为OpenSSL“心脏病失血”事件，Mac OSX 自 10.11 El Capitan 起，原本默认安装的 OpenSSL 被替换为 LibreSSL 。除Mac外，其它使用LibreSSL 取代 OpenSSL的系统还有 **OpenBSD** (`5.6 +`)和 **Alpine Linux** (`3.5.0 +`) 等。
</p>

<p>我当前使用的是Mac OSX 系统10.13.3 版本，在终端中输入<code>openssl version</code>命令 可以看到本地显示的是** LibreSSL <strong>的版本，为<code>LibreSSL 2.2.7</code>。</strong>LibreSSL** 是 OpenBSD 开发者在 OpenSSL 爆出心脏出血漏洞之后 fork 的一个分支，旨在提供一个比 OpenSSL 更安全的替代品，更详细的信息可以参考<a target="_blank" rel="noopener" href="https://hltj.me/security/2017/05/26/libressl-instead-openssl.html">扔掉 OpenSSL，拥抱 LibreSSL</a>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ openssl version</span><br><span class="line">LibreSSL 2.2.7</span><br><span class="line">wendingding$ which openssl</span><br><span class="line">/usr/bin/openssl</span><br></pre></td></tr></table></figure>
<p><strong>说明</strong> 上面的命令用于检查和验证当前系统中使用的openssl的版本和路径(位置)。<strong>LibreSSL</strong>可以理解为更安全的<strong>OpenSSL</strong>，使用方式几乎一致，接下来我就以电脑中已经安装的<code>LibreSSL 2.2.7</code>版本为例进行说明。在终端查看(输入任意无效命令)该工具支持的所有命令，如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">wendingding:openssl wendingding$ openssl help</span><br><span class="line">openssl:Error: &#x27;help&#x27; is an invalid command.</span><br><span class="line"></span><br><span class="line">Standard commands</span><br><span class="line">asn1parse         ca                certhash          ciphers           </span><br><span class="line">crl               crl2pkcs7         dgst              dh                </span><br><span class="line">dhparam           dsa               dsaparam          ec                </span><br><span class="line">ecparam           enc               engine            errstr            </span><br><span class="line">gendh             gendsa            genpkey           genrsa            </span><br><span class="line">nseq              ocsp              passwd            pkcs12            </span><br><span class="line">pkcs7             pkcs8             pkey              pkeyparam         </span><br><span class="line">pkeyutl           prime             rand              req               </span><br><span class="line">rsa               rsautl            s_client          s_server          </span><br><span class="line">s_time            sess_id           smime             speed             </span><br><span class="line">spkac             ts                verify            version           </span><br><span class="line">x509              </span><br><span class="line"></span><br><span class="line">Message Digest commands (see the `dgst&#x27; command for more details)</span><br><span class="line">gost-mac          md4               md5               md_gost94         </span><br><span class="line">ripemd160         sha               sha1              sha224            </span><br><span class="line">sha256            sha384            sha512            streebog256       </span><br><span class="line">streebog512       whirlpool         </span><br><span class="line"></span><br><span class="line">Cipher commands (see the `enc&#x27; command for more details)</span><br><span class="line">aes-128-cbc       aes-128-ecb       aes-192-cbc       aes-192-ecb       </span><br><span class="line">aes-256-cbc       aes-256-ecb       base64            bf                </span><br><span class="line">bf-cbc            bf-cfb            bf-ecb            bf-ofb            </span><br><span class="line">camellia-128-cbc  camellia-128-ecb  camellia-192-cbc  camellia-192-ecb  </span><br><span class="line">camellia-256-cbc  camellia-256-ecb  cast              cast-cbc          </span><br><span class="line">cast5-cbc         cast5-cfb         cast5-ecb         cast5-ofb         </span><br><span class="line">chacha            des               des-cbc           des-cfb           </span><br><span class="line">des-ecb           des-ede           des-ede-cbc       des-ede-cfb       </span><br><span class="line">des-ede-ofb       des-ede3          des-ede3-cbc      des-ede3-cfb      </span><br><span class="line">des-ede3-ofb      des-ofb           des3              desx              </span><br><span class="line">rc2               rc2-40-cbc        rc2-64-cbc        rc2-cbc           </span><br><span class="line">rc2-cfb           rc2-ecb           rc2-ofb           rc4               </span><br><span class="line">rc4-40  </span><br></pre></td></tr></table></figure>

<p>通过上面列出的庞大的可选命令项，不难看出OpenSSL工具的强大和庞大，如果需要获取指定算法的帮助信息，只需要在终端输入<code>openssl 算法名称 --help</code>形式的命令即可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ openssl enc -help</span><br><span class="line">usage: enc -ciphername [-AadePp] [-base64] [-bufsize number] [-debug]</span><br><span class="line">    [-engine id] [-in file] [-iv IV] [-K key] [-k password]</span><br><span class="line">    [-kfile file] [-md digest] [-none] [-nopad] [-nosalt]</span><br><span class="line">    [-out file] [-pass arg] [-S salt] [-salt]</span><br><span class="line"></span><br><span class="line"> -A                 Process base64 data on one line (requires -a)</span><br><span class="line"> -a                 Perform base64 encoding/decoding (alias -base64)</span><br><span class="line"> -bufsize size      Specify the buffer size to use for I/O</span><br><span class="line"> -d                 Decrypt the input data</span><br><span class="line"> -debug             Print debugging information</span><br><span class="line"> -e                 Encrypt the input data (default)</span><br><span class="line"> -engine id         Use the engine specified by the given identifier</span><br><span class="line"> -in file           Input file to read from (default stdin)</span><br><span class="line"> -iv IV             IV to use, specified as a hexidecimal string</span><br><span class="line"> -K key             Key to use, specified as a hexidecimal string</span><br><span class="line"> -md digest         Digest to use to create a key from the passphrase</span><br><span class="line"> -none              Use NULL cipher (no encryption or decryption)</span><br><span class="line"> -nopad             Disable standard block padding</span><br><span class="line"> -out file          Output file to write to (default stdout)</span><br><span class="line"> -P                 Print out the salt, key and IV used, then exit</span><br><span class="line">                      (no encryption or decryption is performed)</span><br><span class="line"> -p                 Print out the salt, key and IV used</span><br><span class="line"> -pass source       Password source</span><br><span class="line"> -S salt            Salt to use, specified as a hexidecimal string</span><br><span class="line"> -salt              Use a salt in the key derivation routines (default)</span><br><span class="line"> -v                 Verbose</span><br><span class="line"></span><br><span class="line">Valid ciphername values:</span><br><span class="line"></span><br><span class="line"> -aes-128-cbc              -aes-128-cfb              -aes-128-cfb1            </span><br><span class="line"> -aes-128-cfb8             -aes-128-ctr              -aes-128-ecb             </span><br><span class="line"> -aes-128-gcm              -aes-128-ofb              -aes-128-xts             </span><br><span class="line"> -aes-192-cbc              -aes-192-cfb              -aes-192-cfb1            </span><br><span class="line"> -aes-192-cfb8             -aes-192-ctr              -aes-192-ecb             </span><br><span class="line"> -aes-192-gcm              -aes-192-ofb              -aes-256-cbc             </span><br><span class="line"> -aes-256-cfb              -aes-256-cfb1             -aes-256-cfb8            </span><br><span class="line"> -aes-256-ctr              -aes-256-ecb              -aes-256-gcm             </span><br><span class="line"> -aes-256-ofb              -aes-256-xts              -aes128                  </span><br><span class="line"> -aes192                   -aes256                   -bf                      </span><br><span class="line"> -bf-cbc                   -bf-cfb                   -bf-ecb                  </span><br><span class="line"> -bf-ofb                   -blowfish                 -camellia-128-cbc        </span><br><span class="line"> -camellia-128-cfb         -camellia-128-cfb1        -camellia-128-cfb8       </span><br><span class="line"> -camellia-128-ecb         -camellia-128-ofb         -camellia-192-cbc        </span><br><span class="line"> -camellia-192-cfb         -camellia-192-cfb1        -camellia-192-cfb8       </span><br><span class="line"> -camellia-192-ecb         -camellia-192-ofb         -camellia-256-cbc        </span><br><span class="line"> -camellia-256-cfb         -camellia-256-cfb1        -camellia-256-cfb8       </span><br><span class="line"> -camellia-256-ecb         -camellia-256-ofb         -camellia128             </span><br><span class="line"> -camellia192              -camellia256              -cast                    </span><br><span class="line"> -cast-cbc                 -cast5-cbc                -cast5-cfb               </span><br><span class="line"> -cast5-ecb                -cast5-ofb                -chacha                  </span><br><span class="line"> -des                      -des-cbc                  -des-cfb                 </span><br><span class="line"> -des-cfb1                 -des-cfb8                 -des-ecb                 </span><br><span class="line"> -des-ede                  -des-ede-cbc              -des-ede-cfb             </span><br><span class="line"> -des-ede-ofb              -des-ede3                 -des-ede3-cbc            </span><br><span class="line"> -des-ede3-cfb             -des-ede3-cfb1            -des-ede3-cfb8           </span><br><span class="line"> -des-ede3-ofb             -des-ofb                  -des3                    </span><br><span class="line"> -desx                     -desx-cbc                 -gost89                  </span><br><span class="line"> -gost89-cnt               -gost89-ecb               -id-aes128-GCM           </span><br><span class="line"> -id-aes192-GCM            -id-aes256-GCM            -rc2                     </span><br><span class="line"> -rc2-40-cbc               -rc2-64-cbc               -rc2-cbc                 </span><br><span class="line"> -rc2-cfb                  -rc2-ecb                  -rc2-ofb                 </span><br><span class="line"> -rc4        </span><br></pre></td></tr></table></figure>

<div class='titleX'>**opsnssl + 单向散列函数应用**</div>
<span style='border:0.2px solid #000;padding:5px 20px;background:#f8f8f0;color:#555'>** 单向散列函数的特点**</span>
>**① 散列计算后的密文是定长的。**
>**② 明文相同，密文一定相同。**
>**③ 明文不同，密文一定不同。**
>**④ 计算过程不可逆，算法公开，效率高性能好。**

<p><strong>经典加密算法</strong> MD5加密 、SHA1 和 SHA512等<br><strong>散列函数进阶</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1）先加盐，然后再进行MD5</span><br><span class="line">2）先乱序，再进行MD5加密</span><br><span class="line">3）乱序 | 加盐，多次MD5加密等</span><br><span class="line">4）使用消息认证机制，即HMAC-MD5-先对密钥进行加密，加密之后进行两次MD5散列</span><br></pre></td></tr></table></figure>

<p><code>001 对字符串进行简单的MD5加密</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ echo -n &quot;wendingding&quot; | md5</span><br><span class="line">d661517da45e21c9d180ad50ffcdf18d</span><br></pre></td></tr></table></figure>
<p><code>002 对任意的文件进行MD5加密</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ ls -a</span><br><span class="line">.		.DS_Store	All		Node		Vue</span><br><span class="line">..		123.png		Canvas		Other</span><br><span class="line">wendingding$ md5 123.png </span><br><span class="line">MD5 (123.png) = 2feeda7a43bc96b94fa0fbe64673a593</span><br></pre></td></tr></table></figure>
<p><code>003 使用sha家族算法来对字符串进行加密</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ echo -n &quot;wendingding&quot; | openssl sha -sha1</span><br><span class="line">(stdin)= 13fb6a32c9876c0b4aa05c5e930ff9332f84c62d</span><br><span class="line"></span><br><span class="line">wendingding$ echo -n &quot;wendingding&quot; | openssl sha -sha256</span><br><span class="line">(stdin)= a3c02021d3630ec36fd07c4f14236cac691f499bc47428a245e8618319d812df</span><br><span class="line"></span><br><span class="line">wendingding$ echo -n &quot;wendingding&quot; | openssl sha -sha512</span><br><span class="line">(stdin)= 9b4c77e0e1a99b99fc46bfa58dab5070d707b84384a8659c69b19442d1d19490cf63b145b645c7</span><br><span class="line">a7fe42ffba9a3bff800911f5957bc6a0a219b708c6c2dc9c2c</span><br></pre></td></tr></table></figure>
<p><code>004 对字符串应用hmacMD5加密</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ echo -n &quot;wendingding&quot; |openssl dgst -md5 -hmac &quot;123&quot;</span><br><span class="line">(stdin)= 82fce83fe44d72969f69565f3b16d3e9</span><br></pre></td></tr></table></figure>
<p class='tip'>
消息认证机制（HMAC）原理是：消息的发送者和接收者有一个共享密钥，发送者使用共享密钥对消息加密计算得到MAC值，消息接收者使用共享密钥对消息加密计算得到MAC值，比较两个MAC值是否一致。在具体使用的时候，客户端需要在发送的时候把`（消息）+（消息·HMAC）`打包发送给服务器，服务器接收到数据后，对拿到的消息用共享的KEY进行HMAC，比较是否一致，如果一致则信任。
</p>

<div class='titleX'>**opsnssl + 对称加密算法**</div>
<span style='border:0.2px solid #000;padding:5px 20px;background:#f8f8f0;color:#555'>** 对称加密算法的特点**</span>
>**① 加密/解密使用相同的密钥。**
>**② 加密和解密的过程是可逆的。**
>**③ 效率高、性能好，但是存在密钥传输安全问题。**

<p><strong>经典加密算法</strong> DES、3DES 和 AES 等</p>
<p><code>001 AES-ECB加密的过程</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ mkdir openssl</span><br><span class="line">wendingding$ cd openssl/</span><br><span class="line">wendingding$ echo &quot;测试的字符串-des加密&quot; &gt;&gt; 123.txt</span><br><span class="line">wendingding$ cat 123.txt </span><br><span class="line">测试的字符串-des加密</span><br><span class="line">wendingding$ ls -a</span><br><span class="line">.	..	123.txt</span><br><span class="line">wendingding$ openssl enc -des-ecb -K 616263 -nosalt -in 123.txt -out 123.bin</span><br><span class="line">wendingding:openssl wendingding$ ls -a</span><br><span class="line">.	..	123.bin	123.txt</span><br></pre></td></tr></table></figure>
<p><code>002 AES-ECB解密的过程</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ openssl enc -des-ecb -K 616263 -nosalt -in 123.bin -out 123_new.txt -d</span><br><span class="line">wendingding$ cat 123_new.txt </span><br><span class="line">测试的字符串-des加密</span><br></pre></td></tr></table></figure>
<blockquote>
<p>密码算法可以分为分组密码和流密码两种。 </p>
</blockquote>
<p>**<code>分组密码</code>**的特点是在解密和解密时，每次只能处理特定长度的一组数据，一个分组的比特数量就称之为分组长度。DES 和 3DES 的分组长度都是64比特，也就是每次只能加密64比特的明文，并生成64比特的密文。AES 的分组长度有128比特、192比特和256比特可以选择。</p>
<p>**<code>流密码</code>**的特点是加密和解密时会对数据流进行连续处理。流密码中一般以1比特、8比特或者是32比特等作为单位俩进行加密和解密。</p>
<p class='tip'> **备注** 分组密码算法在具体实现的时候，又有很多的分组模式可以选择。常见的分组模式有 ECB 和 CBC 等。ECB模式的全称为 `Electronic CodeBook`模式，CBC模式全称为 `Cipher Block Chainning`模式，它的特点是分组后先将明文分组与前一个密文分组进行XOR运算，然后再进行加密。关于CBC和ECB的具体细节可以参考[数据安全系列 术语](http://wendingding.com/2018/08/02/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8%E7%B3%BB%E5%88%97%20%E4%B8%93%E4%B8%9A%E6%9C%AF%E8%AF%AD%E9%87%8A%E4%B9%89/)这篇文章。</p>

<p><code>003 AES-CBC加密的过程</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ echo &quot;测试aes-cbc&quot; &gt;&gt; a.txt</span><br><span class="line">$ ls -a</span><br><span class="line">.		123.bin		123_new.txt</span><br><span class="line">..		123.txt		a.txt</span><br><span class="line">$ openssl enc -des-cbc -K 616263 -iv 0102030405060708 -nosalt -in a.txt -out a.bin</span><br><span class="line">$ ls -a</span><br><span class="line">.		123.bin		123_new.txt	a.txt</span><br><span class="line">..		123.txt		a.bin</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>004 AES-CBC解密的过程</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ openssl enc -des-cbc -K 616263 -iv 0102030405060708 -nosalt -in a.bin -out a_new.txt -d</span><br><span class="line">$ ls -a</span><br><span class="line">.		123.bin		123_new.txt	a.txt</span><br><span class="line">..		123.txt		a.bin		a_new.txt</span><br><span class="line">$ cat a_new.txt </span><br><span class="line">测试aes-cbc</span><br></pre></td></tr></table></figure>
<p><strong>说明</strong> 上文命令行中的<code>-iv 0102030405060708</code>是CBC分组模式需要使用到的初始向量值。</p>
<div class='titleX'>**opsnssl + 非对称加密算法**</div>
<span style='border:0.2px solid #000;padding:5px 20px;background:#f8f8f0;color:#555'>** 非对称加密算法的特点**</span>
>**① 加密的时候使用公钥，解密的时候使用私钥。**
>**② 公钥是公开的，私钥是绝对保密的。**
>**③ 效率不高，性能不好，可能会遭遇中间人攻击。**

<p><strong>经典加密算法</strong> RSA</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">这里简单介绍RSA算法的原理和小示例</span><br><span class="line"></span><br><span class="line">    [<span class="number">1</span>] RSA 原理</span><br><span class="line">        （<span class="number">1</span>）求N，准备两个质数p和q,N = p x q</span><br><span class="line">        （<span class="number">2</span>）求L,L是p-<span class="number">1</span>和q-<span class="number">1</span>的最小公倍数。L = lcm（p-<span class="number">1</span>,q-<span class="number">1</span>）</span><br><span class="line">        （<span class="number">3</span>）求E，E和L的最大公约数为<span class="number">1</span>（E和L互质）</span><br><span class="line">        （<span class="number">4</span>）求D，E x D mode L = <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">    [<span class="number">2</span>] RSA加密小实践</span><br><span class="line">        （<span class="number">1</span>）p = <span class="number">17</span>,q = <span class="number">19</span> =&gt;N = <span class="number">323</span></span><br><span class="line">        （<span class="number">2</span>）lcm（p-<span class="number">1</span>,q-<span class="number">1</span>）=&gt;lcm（<span class="number">16</span>，<span class="number">18</span>）=&gt;L= <span class="number">144</span></span><br><span class="line">        （<span class="number">3</span>）gcd（E,L）=<span class="number">1</span> =&gt;E=<span class="number">5</span></span><br><span class="line">        （<span class="number">4</span>）E乘以几可以mode L =<span class="number">1</span>? D=<span class="number">29</span>可以满足</span><br><span class="line">        （<span class="number">5</span>）得到公钥为：E=<span class="number">5</span>,N=<span class="number">323</span></span><br><span class="line">        （<span class="number">6</span>）得到私钥为：D=<span class="number">29</span>,N=<span class="number">323</span></span><br><span class="line">        （<span class="number">7</span>）加密 明文的E次方 mod N = <span class="number">123</span>的<span class="number">5</span>次方  mod <span class="number">323</span> = <span class="number">225</span>（密文）</span><br><span class="line">        （<span class="number">8</span>）解密 密文的D次方 mod N = <span class="number">225</span>的<span class="number">29</span>次方 mod <span class="number">323</span> = <span class="number">123</span>（明文）</span><br></pre></td></tr></table></figure>

<p><strong>非对称加密命令行介绍</strong></p>
<p><code>001 生成512位的RSA私钥</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ openssl genrsa -out private.pem 512</span><br><span class="line">Generating RSA private key, 512 bit long modulus</span><br><span class="line">........+++++++++++++++++++++++++++</span><br><span class="line">..+++++++++++++++++++++++++++</span><br><span class="line">e is 65537 (0x10001)</span><br></pre></td></tr></table></figure>

<p><code>002  以明文输出私钥内容</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ openssl rsa -in private.pem -text -out private.txt</span><br><span class="line">writing RSA key</span><br></pre></td></tr></table></figure>

<p><code>003 校验私钥文件</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ openssl rsa -in private.pem -check</span><br><span class="line">RSA key ok</span><br><span class="line">writing RSA key</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIBOwIBAAJBAKfq2SR+2arBoS1c+Jc8Pt7N6Jus4IaqvFttbBaBriVm/EFGY5c0</span><br><span class="line">eS4lDVwLWr0ld2bee720855YkFEsa6j9IlECAwEAAQJBAJwiSOogcTDPfpj5m8S0</span><br><span class="line">JhlyCNnH87YER8QTiK+cwVrQV7AVMNaNWMa4hKZh/rsXTD5oPemUsTTjEWNNNjbE</span><br><span class="line">o+kCIQDZypEycPx1knONDQSVbJwhEsFfnC81BPRUglAyLLK1NwIhAMVgWK6q5vI5</span><br><span class="line">ZKR73XhoHMC3OLE3alvx43JnD0TE+yi3AiAU618tACtPw8RznPd+vtL0Xk/StjbW</span><br><span class="line">meY6I9Y+K4ry2wIhAIPI9q15MsZch9RDV/aDHV+XdmTtKTjG4ySJp2o1U7U1AiBG</span><br><span class="line">IM0D897qkeovClo3kw/mFDA9lgfJu1ir0W3OLSmvXg==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>
<p><code>004 从私钥中提取公钥</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ openssl rsa -in private.pem -out public.pem -outform PEM -pubout</span><br><span class="line">writing RSA key</span><br></pre></td></tr></table></figure>
<p><code>005 以明文输出公钥内容</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ openssl rsa -in public.pem -out public.txt -pubin -pubout -text</span><br><span class="line">writing RSA key</span><br><span class="line"></span><br><span class="line">wendingding$ cat public.txt</span><br><span class="line">Public-Key: (512 bit)</span><br><span class="line">Modulus:</span><br><span class="line">    00:a7:ea:d9:24:7e:d9:aa:c1:a1:2d:5c:f8:97:3c:</span><br><span class="line">    3e:de:cd:e8:9b:ac:e0:86:aa:bc:5b:6d:6c:16:81:</span><br><span class="line">    ae:25:66:fc:41:46:63:97:34:79:2e:25:0d:5c:0b:</span><br><span class="line">    5a:bd:25:77:66:de:7b:bd:b4:f3:9e:58:90:51:2c:</span><br><span class="line">    6b:a8:fd:22:51</span><br><span class="line">Exponent: 65537 (0x10001)</span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAKfq2SR+2arBoS1c+Jc8Pt7N6Jus4Iaq</span><br><span class="line">vFttbBaBriVm/EFGY5c0eS4lDVwLWr0ld2bee720855YkFEsa6j9IlECAwEAAQ==</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>

<p><code>006 使用公钥加密文件</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ echo &quot;rsa算法测试&quot; &gt;&gt; msg.txt</span><br><span class="line">wendingding$ openssl rsautl -encrypt -pubin -inkey public.pem -in msg.txt -out msg.bin</span><br><span class="line">wendingding$ ls -l</span><br><span class="line">total 48</span><br><span class="line">-rw-r--r--  1 wendingding  staff    64  2 24 18:20 msg.bin</span><br><span class="line">-rw-r--r--  1 wendingding  staff    16  2 24 18:20 msg.txt</span><br><span class="line">-rw-r--r--  1 wendingding  staff   497  2 24 18:19 private.pem</span><br><span class="line">-rw-r--r--  1 wendingding  staff  1626  2 24 18:19 private.txt</span><br><span class="line">-rw-r--r--  1 wendingding  staff   182  2 24 18:19 public.pem</span><br><span class="line">-rw-r--r--  1 wendingding  staff   458  2 24 18:19 public.txt</span><br></pre></td></tr></table></figure>
<p><code>007 对加密后的文件进行解密操作</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wendingding$ openssl rsautl -decrypt -inkey private.pem -in msg.bin -out a.txt</span><br><span class="line">wendingding$ cat a.txt</span><br><span class="line">rsa算法测试</span><br><span class="line"></span><br><span class="line">wendingding$ md5 a.txt </span><br><span class="line">MD5 (a.txt) = f0f64bc1852acfd133e27567bd71c92e</span><br><span class="line"></span><br><span class="line">wendingding$ md5 msg.txt </span><br><span class="line">MD5 (msg.txt) = f0f64bc1852acfd133e27567bd71c92e</span><br></pre></td></tr></table></figure>

<img src='../../../../z.png' width="200px">

<hr>
<ul>
<li>Posted by 博客园·<a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a> | <a target="_blank" rel="noopener" href="http://wendingding.com/">花田半亩</a></li>
<li>联系作者 简书·<a target="_blank" rel="noopener" href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2019/03/01/%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87-webpack%E6%89%93%E5%8C%85%E5%87%BA%E9%94%99/" class="prev">上一篇</a><a href="/2019/02/12/%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87-raw.githubusercontent.com/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2022 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计 422.4k (字)</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>