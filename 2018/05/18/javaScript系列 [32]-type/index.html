<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> javaScript系列 [32]- type · 花田半亩</title><meta name="description" content="javaScript系列 [32]- type - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="花田半亩" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="https://github.com/flowerField" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">javaScript系列 [32]- type</h1><div class="post-info">May 18, 2018<span class="post-count"></span> ✧ 字数统计:1.3k(字) &nbsp;&nbsp; ♨︎ 阅读时长:5(分钟)</div><div class="post-content"><div class='tip'>本文介绍 JavaScript 中的数据类型，以及这些数据的类型检测方式。</div>

<p>JavaScript 存在很多中数据类型，按照一贯的区分方式，我们把这些数据类型分为两大类，分别是原始(基本)数据类型和对象类型。</p>
<p>其中基本( 原始 )数据类型有6种，分别是 <code>null undefined boolean string number symbol</code>，对象类型则为<code>object</code>，对象类型中包含<code>Object、Array、RegExp、Function、Error、Set、Map、WeakMap</code>等。</p>
<p>在JavaScript 代码中我们经常需要对数据的类型进行检查，检查数据类型的方式主要有四种：</p>
<ul>
<li>typeof     关键字</li>
<li>instanceof 关键字</li>
<li>Object.prototype.toString.call() </li>
<li>constructor 构造器属性</li>
</ul>
<div class='titleX'>**typeof 关键字**</div>

<p><code>typeof</code> 关键字是检查数据类型最简单也最常用的方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="string">&quot;abc&quot;</span>)                   <span class="comment">/* string */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="number">12345</span>)                   <span class="comment">/* number */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">true</span>)                    <span class="comment">/* boolean */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">undefined</span>)               <span class="comment">/* undefined */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="built_in">Symbol</span>())                <span class="comment">/* symbol */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="literal">null</span>)                    <span class="comment">/* object */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="keyword">typeof</span> <span class="keyword">typeof</span> <span class="built_in">Symbol</span>())  <span class="comment">/* string */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> &#123;&#125;)                      <span class="comment">/* object */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> [])                      <span class="comment">/* object */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> /abc/)                   <span class="comment">/* object */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">typeof</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)            <span class="comment">/* function */</span></span><br></pre></td></tr></table></figure>

<p>我们在使用<code>typeof</code> 关键字的时候，有一些注意点。</p>
<p>首先就是 <code>typeof null</code> 得到的结果为<code>object</code> 而非<code>null</code>，这在 JavaScript 语言中被认为(承认)是一个设计错误，<code>typeof null</code> 被判定为 <code>object</code> 的原因在于 <code>null</code> 本身表示什么都没有，所以在计算机中表示为一串0，而计算机内部处理的时候如果读取的数据总是以<code>000</code>开头，那么就将被认为是对象类型的数据。</p>
<p>其次，<code>typeof</code> 关键字在对象类型进行运算的时候得到的都是<code>object</code>，只有函数类型比较特殊得到的是<code>function</code>，也就是说我们无法通过该关键字来检查给定的数据是否是数组、或者是正则表达式等等。如果需要获取这些结构的数据类型，或者说是获取这些数据的构造函数，常用的方式是借用 Object 原型对象上面的 toString 方法来实现，该方法总是会返回一个<code>[object 构造函数]</code>结构的字符串。</p>
<div class='titleX'>**Object.prototype.toString 方法**</div>

<p>JavaScript 语言中的<code>Object.prototype.toString</code>方法总是会返回<code>[object 构造函数]</code>结构的字符串，其中方括号中前面的<code>object</code>表明该数据是对象类型的，后面的则是创建该实例的构造函数。如果是一个普通的对象，譬如<code>&#123;name:&quot;zs&quot;&#125;</code>,在调用该方法的时候 [<code>代码为:(&#123;name:&quot;zs&quot;&#125;).toString()</code>]得到的结果为<code>[object object]</code>, 但因为原型链方法覆盖的问题，数组或其它类型的数据则无法直接调用该方法。对于除普通对象外的其它对象类型的数据而言，它们需要通过 call 或 apply 绑定 this 的方式才能调用该方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log((&#123;&#125;).toString())                              <span class="comment">/* [object Object] */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(&#123;&#125;))           <span class="comment">/* [object Object] */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call([]))           <span class="comment">/* [object Array] */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">Function</span>)) <span class="comment">/* [object Function]*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">RegExp</span>))   <span class="comment">/* [object RegExp] */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">Error</span>))    <span class="comment">/* [object Error] */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">Set</span>))      <span class="comment">/* [object Set] */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(<span class="keyword">new</span> <span class="built_in">Map</span>))      <span class="comment">/* [object Map] */</span></span><br></pre></td></tr></table></figure>

<p>一般而言<code>Object.prototype.toString</code> 方法很好用，<strong>But</strong> 它也不是万能的，譬如它无法处理自定义类型的类型检查( 包括自定义构造函数 和 Class 等)。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;&#125;;</span><br><span class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> Animal;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(p)) <span class="comment">/* [object Object] */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.prototype.toString.call(a)) <span class="comment">/* [object Object] */</span></span><br></pre></td></tr></table></figure>

<p>对于自定义类型的数据，我们需要通过 instanceof 或者是 constructor 来进行检查。</p>
<div class='titleX'>** instanceof 关键字 **  &&  ** constructor 构造器属性**</div>

<p>JavaScript 语言中的 <code>instanceof</code> 关键字用于检查某个对象是否是指定构造函数创建的实例对象，在检查的时候会检查整条原型链。如果准确点说，那么<code>instanceof</code> 实际上检查的是某个对象( 左值 )是否在指定构造函数( 右值 )的原型链上面，如果在那么就返回 true ,否则的话就返回 false。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(p <span class="keyword">instanceof</span> Person)                            <span class="comment">/* true */</span></span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> Person)                            <span class="comment">/* false */</span></span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> Animal)                            <span class="comment">/* true */</span></span><br><span class="line"><span class="built_in">console</span>.log(a <span class="keyword">instanceof</span> <span class="built_in">Function</span>, a <span class="keyword">instanceof</span> <span class="built_in">Object</span>)     <span class="comment">/* false true */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a.constructor == Person);                       <span class="comment">/* false */</span></span><br><span class="line"><span class="built_in">console</span>.log(a.constructor == Animal);                       <span class="comment">/* true */</span></span><br><span class="line"><span class="built_in">console</span>.log(a.constructor == <span class="built_in">Object</span>);                       <span class="comment">/* false */</span></span><br><span class="line"><span class="built_in">console</span>.log(p.constructor == Person);                       <span class="comment">/* true */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log((&#123;&#125;).constructor == <span class="built_in">Object</span>)                     <span class="comment">/* true */</span></span><br><span class="line"><span class="built_in">console</span>.log(([]).constructor == <span class="built_in">Array</span>)                      <span class="comment">/* true */</span></span><br></pre></td></tr></table></figure>

<p>这里试着给出<code>instanceof</code>关键字的实现代码，其实就是个死循环和循环内原型查找而已。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* instanceof 实现原理 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mockInstanceof</span>(<span class="params">instance,constructor</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> B = <span class="title">constructor</span>.<span class="title">prototype</span>;</span><br><span class="line">  <span class="keyword">let</span> A = instance.__proto__;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment">/* Object.prototype.__proto__ -&gt; null */</span></span><br><span class="line">    <span class="keyword">if</span> (A == <span class="literal">null</span>)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (A === B)&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    A = A.__proto__;   </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 测试数据 */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>) </span>&#123; &#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Boy</span>(<span class="params"></span>) </span>&#123; &#125;;</span><br><span class="line"><span class="keyword">let</span> p = <span class="keyword">new</span> Person;</span><br><span class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> Boy;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(mockInstanceof(p, Person))          <span class="comment">/* true */</span></span><br><span class="line"><span class="built_in">console</span>.log(mockInstanceof(p, <span class="built_in">Object</span>))          <span class="comment">/* true */</span></span><br><span class="line"><span class="built_in">console</span>.log(mockInstanceof(b, Boy))             <span class="comment">/* true */</span></span><br><span class="line"><span class="built_in">console</span>.log(mockInstanceof(b, Person))          <span class="comment">/* false */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src='../../../../z.png' width="200px">

<hr>
<ul>
<li>Posted by 博客园·<a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a> | <a target="_blank" rel="noopener" href="http://wendingding.com/">花田半亩</a></li>
<li>联系作者 简书·<a target="_blank" rel="noopener" href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/05/18/javaScript%E7%B3%BB%E5%88%97%20%5B33%5D-new/" class="prev">上一篇</a><a href="/2018/05/18/javaScript%E7%B3%BB%E5%88%97%20%5B31%5D-call%20&amp;&amp;%20apply%20&amp;&amp;%20bind/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2022 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计 422.4k (字)</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>