<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> TypeScript系列 [05]-TypeScript语言特性(四) · 花田半亩</title><meta name="description" content="TypeScript系列 [05]-TypeScript语言特性(四) - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="花田半亩" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="https://github.com/flowerField" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">TypeScript系列 [05]-TypeScript语言特性(四)</h1><div class="post-info">Jun 23, 2018<span class="post-count"></span> ✧ 字数统计:3.8k(字) &nbsp;&nbsp; ♨︎ 阅读时长:14(分钟)</div><div class="post-content"><blockquote>
<p>本文主要对TypeScript中的函数进行展开介绍。主要包括以下内容</p>
<p>❏  函数的创建和类型<br>❏  函数参数情况说明<br>❏  泛型函数简单介绍</p>
</blockquote>
<h3 id="函数的创建和类型"><a href="#函数的创建和类型" class="headerlink" title="函数的创建和类型"></a>函数的创建和类型</h3><p><strong>函数的创建</strong></p>
<p>函数的创建主要有两种方式：<code>通过函数声明创建</code>和<code>通过函数表达式创建</code>，在形式上函数又可以被划分文<code>命名函数</code>和<code>匿名函数</code>。此外，TypeScript中还提供了箭头函数支持，在声明箭头函数的时候，我们不再使用function关键字转而使用=&gt;标记。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文件路径 ..07-函数深入讲解/01-函数的创建.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//测试变量声明提升</span></span><br><span class="line"><span class="built_in">console</span>.log(getName);   <span class="comment">//函数</span></span><br><span class="line"><span class="built_in">console</span>.log(getNameT);  <span class="comment">//undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(f1);        <span class="comment">//undefined</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//[001] 函数声明的方式创建(命名函数)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params">name:string</span>):<span class="title">string</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;getName函数=&gt;姓名 ：&quot;</span> + name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//[002] 函数表达式的方式创建(匿名函数)</span></span><br><span class="line"><span class="keyword">var</span> getNameT = <span class="function"><span class="keyword">function</span> (<span class="params">name:string</span>):<span class="title">string</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;getNameT函数=&gt;姓名 ：&quot;</span> + name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//[003] 箭头函数</span></span><br><span class="line"><span class="keyword">var</span> f1 = (name:string):<span class="function"><span class="params">string</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;f1函数=&gt;姓名 ：&quot;</span> + name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(getName(<span class="string">&quot;文顶顶&quot;</span>));            <span class="comment">//getName函数=&gt;姓名 ：文顶顶</span></span><br><span class="line"><span class="built_in">console</span>.log(getNameT(<span class="string">&quot;wendingding.com&quot;</span>)); <span class="comment">//getNameT函数=&gt;姓名 ：wendingding.com</span></span><br><span class="line"><span class="built_in">console</span>.log(f1(<span class="string">&quot;奥特曼&quot;</span>));                 <span class="comment">//f1函数=&gt;姓名 ：奥特曼</span></span><br></pre></td></tr></table></figure>

<p>因为JavaScript语言中<code>变量声明提升</code>的特性，所以<strong>通过函数声明方式创建的命名函数</strong>和<strong>通过函数表达式方式创建的匿名函数</strong>其使用特征也很不一样。熟悉JavaScript语言中<code>变量提升</code>特性的开发者应该非常清楚，所谓变量声明的提升，指的是在真正执行JavaScript代码前解释器会有个预解析的阶段，在这个阶段中会检查代码中所有的变量声明并把这些声明提升到当前作用域的顶部。</p>
<div class='tip'>需要注意的是，很多人可能并不能够准确的区分清楚代码中哪部分是变量声明，哪部分不属于它，这里进行简单说明。</div>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//(1)表示声明一个变量a，并未赋值</span></span><br><span class="line"><span class="keyword">var</span> a;   </span><br><span class="line"><span class="comment">//(2)表示声明一个变量b,并把123赋值给变量b</span></span><br><span class="line"><span class="comment">//这行代码有两部分组成，其结构为 声明 + 赋值</span></span><br><span class="line"><span class="comment">//等价于 var b; b = 123;两行代码</span></span><br><span class="line"><span class="keyword">var</span> b = <span class="number">123</span>;</span><br></pre></td></tr></table></figure>
<p><span style='color:#195'>JavaScript预解析阶段在进行变量声明提升的时候，仅仅会把变量的声明部分进行提升，而赋值操作留在原地</span>。因为函数其实本质上也是变量，所以同样适用上面的规则。</p>
<p><strong>代码说明：</strong>观察第一份示例代码，代码中以函数声明方式创建的命名函数getName，其作为函数(变量)声明在预解析阶段会被整体提升，而匿名函数（赋值给了变量getNameT）因为有赋值操作，所以在预解析阶段只会将变量声明这部分(var getNameT)提升到作用域顶部，赋值操作会被留在原地。</p>
<p><strong>函数的类型</strong></p>
<p>我们知道在TypeScript语言中，可以使用可选的类型声明来显示的指定变量的类型，函数其实也算是变量，多以我们可以在声明函数的时候，显示的声明其类型。</p>
<p>我们先看下面的函数示例代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">num1:number,num2:number</span>):<span class="title">string</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;传入的参数分别为:&quot;</span>+num1+<span class="string">&quot;和 &quot;</span>+ num2 + <span class="string">&quot;add的结果为:&quot;</span> + (num1 + num2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码中声明了add函数，并指定了该函数需要接受两个number类型的参数（分别为num1和num2），返回值为字符串类型。其实作为特殊的变量，我们也可以给函数也声明类型，在进行函数类型声明的时候，其语法结构同变量可选的类型声明没什么两样，结构均为：<span style='color:red'>声明变量键字 + 变量(函数)名 ：类型</span>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//001 声明变量</span></span><br><span class="line"><span class="keyword">let</span> str:string;</span><br><span class="line"><span class="comment">//002 声明变量并做初始化赋值操作</span></span><br><span class="line"><span class="keyword">let</span> sum:number = <span class="number">123</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//[001]提供函数变量并显示的声明函数的类型（参数和返回值等情况）</span></span><br><span class="line"><span class="keyword">let</span> f1:<span class="function">(<span class="params">name:string,age:number</span>) =&gt;</span> string;</span><br><span class="line"><span class="comment">//赋值操作</span></span><br><span class="line">f1 = <span class="function"><span class="keyword">function</span> (<span class="params">name:string,age:number</span>):<span class="title">string</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;姓名:&quot;</span> +name + <span class="string">&quot;年龄:&quot;</span> + age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//函数调用</span></span><br><span class="line">str = f1(<span class="string">&quot;zs&quot;</span>,<span class="number">18</span>);</span><br><span class="line"><span class="built_in">console</span>.log(str);   <span class="comment">//姓名:zs年龄:18</span></span><br></pre></td></tr></table></figure>
<p><code>let f1:(name:string,age:number) =&gt; string;</code>这行代码中的<code>(name:string,age:number) =&gt; string</code>用于表示函数的具体类型，我们可以发现函数的类型声明由三部分组成：<code>形参</code> + <code> =&gt;标记</code> +<code> 返回值类型</code>。上面的代码中函数的类型声明和赋值操作是分开处理的，你当然也可以像普通变量那样把这两个操作合二为一，下面给出改写后的代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//[002] 声明函数（函数被指定了类型）</span></span><br><span class="line"><span class="keyword">let</span> str1:string;</span><br><span class="line"><span class="keyword">let</span> f2:<span class="function">(<span class="params">name:string,age:number</span>) =&gt;</span> string = <span class="function"><span class="keyword">function</span> (<span class="params">name:string,age:number</span>):<span class="title">string</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;姓名:&quot;</span> +name + <span class="string">&quot;年龄:&quot;</span> + age;</span><br><span class="line">&#125;  </span><br><span class="line">str1 = f2(<span class="string">&quot;zs&quot;</span>,<span class="number">18</span>);</span><br><span class="line"><span class="built_in">console</span>.log(str1);    <span class="comment">//姓名:zs年龄:18</span></span><br></pre></td></tr></table></figure>
<p><strong>建议：</strong><span  style='color:#195'>在使用TypeScript设计函数的时候，不建议像上面示例代码这样来为函数指明类型，因为函数的类型可以从被赋值的函数推断出来，因此我们给函数添加类型声明并不是必需的，相反这样做还会让代码变得冗余且难以理解和阅读。</span></p>
<h3 id="函数参数情况说明"><a href="#函数参数情况说明" class="headerlink" title="函数参数情况说明"></a>函数参数情况说明</h3><p><strong>可选参数</strong></p>
<p>在使用JavaScript设计函数的时候，如何函数调用时传入的实参和声明时的形参不一致也能工作，但TypeScript中会对函数参数的类型以及参数的个数进行更严格的检查，我们来看下面的代码示例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//函数声明</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">name:string,age:number,isStudent:boolean</span>) : <span class="title">string</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> result:string;</span><br><span class="line">  result = <span class="string">&quot;姓名: &quot;</span> + name + <span class="string">&quot;年龄: &quot;</span> + age;</span><br><span class="line">  <span class="keyword">if</span>(isStudent)</span><br><span class="line">  &#123;</span><br><span class="line">    result += <span class="string">&quot; 是否为学生? &quot;</span> + isStudent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数调用</span></span><br><span class="line"><span class="built_in">console</span>.log(getInfo(<span class="string">&quot;文顶顶&quot;</span>,<span class="number">18</span>,<span class="literal">true</span>));  <span class="comment">//姓名: 文顶顶 年龄: 18 是否为学生? true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//错误的演示：error TS2554: Expected 3 arguments, but got 2.</span></span><br><span class="line"><span class="built_in">console</span>.log(getInfo(<span class="string">&quot;文顶顶&quot;</span>,<span class="number">20</span>));</span><br></pre></td></tr></table></figure>
<p>如果函数中某些参数并非必须的，我们希望该函数在调用的时候无论是否传递某些参数，函数都要能够继续工作，这需要用上TypeScript为我们提供的<span style='color:#195'>可选参数特性</span>。</p>
<p><span style='color:#f25'>函数可选参数的具体用法非常简单，我们只需要在函数形参名称后面加上一个？字符即可</span>，调整getInfo方法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文件路径 ../07-函数深入讲解/03-函数的可选参数02.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//函数声明</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">name:string,age:number,isStudent?:boolean</span>) : <span class="title">string</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> result:string;</span><br><span class="line">  result = <span class="string">&quot;姓名: &quot;</span> + name + <span class="string">&quot; 年龄: &quot;</span> + age;</span><br><span class="line">  <span class="keyword">if</span>(isStudent)</span><br><span class="line">  &#123;</span><br><span class="line">    result += <span class="string">&quot; 是否为学生? &quot;</span> + isStudent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数调用</span></span><br><span class="line"><span class="built_in">console</span>.log(getInfo(<span class="string">&quot;文顶顶&quot;</span>,<span class="number">18</span>,<span class="literal">true</span>));  <span class="comment">//姓名: 文顶顶 年龄: 18 是否为学生? true</span></span><br><span class="line"><span class="built_in">console</span>.log(getInfo(<span class="string">&quot;文顶顶&quot;</span>,<span class="number">20</span>));       <span class="comment">//姓名: 文顶顶 年龄: 20</span></span><br></pre></td></tr></table></figure>
<div class='tip'>注意：所有的可选参数必须位于必选参数列表的最后。</div>

<p><strong>参数的默认值</strong></p>
<p>当函数中存在可选参数的时候，在函数体中我们必须要对可选参数是否传递进行检测，这种情况我们使用<code>为可选参数设置默认值</code>会更合适。</p>
<p>在上面的代码中，因为getInfo函数的isStudent属性是可选的，所以我们在函数体内的实现代码中访问isStudent前必须先进行检查，而通过<code>形参名称 ： 参数类型 = 默认值的</code>方式能够避免这样做，还能够大大的提升代码的可阅读性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文件路径 ../07-函数深入讲解/05-函数的可选参数03.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//函数声明</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getInfo</span>(<span class="params">name:string,age:number,isStudent:boolean = <span class="literal">false</span></span>) : <span class="title">string</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;姓名: &quot;</span> + name + <span class="string">&quot; 年龄: &quot;</span> + age +  <span class="string">&quot; 是否为学生? &quot;</span> + isStudent;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数调用</span></span><br><span class="line"><span class="built_in">console</span>.log(getInfo(<span class="string">&quot;文顶顶&quot;</span>,<span class="number">18</span>,<span class="literal">true</span>));  <span class="comment">//姓名: 文顶顶 年龄: 18 是否为学生? true</span></span><br><span class="line"><span class="built_in">console</span>.log(getInfo(<span class="string">&quot;文顶顶&quot;</span>,<span class="number">20</span>));       <span class="comment">//姓名: 文顶顶 年龄: 20 是否为学生? false</span></span><br></pre></td></tr></table></figure>
<div class='tip'>注意：所有设置默认值的参数必须位于所有必选参数列表的最后。</div>

<p><strong>参数不确定的函数</strong></p>
<p>我们在设计函数的时候，有时该函数能够接受的参数个数是不确定的，比如说现在需要设计一个计算累加和的函数，该函数能够接受任意多个number类型的数据。我们可以通过<code>...形参名:参数类型</code>的方式来处理这种情况。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文件路径 ../07-函数深入讲解/06-函数的参数不确定.ts</span></span><br><span class="line"><span class="comment">//[001] 在声明函数的时候，不提供形参和类型声明</span></span><br><span class="line"><span class="comment">//TypeScript编译不通过，当调用时候报错：sum函数接收的参数个数为0</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</span><br><span class="line">        result += <span class="built_in">arguments</span>[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">sum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line">sum(<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//[002] 在声明函数的时候，不提供形参和类型声明</span></span><br><span class="line"><span class="comment">//TypeScript编译不通过，当调用时候报错：sum函数接收的参数个数为0</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum1</span>(<span class="params">...numbers:number[]</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result:number = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; numbers.length; i++) &#123;</span><br><span class="line">        result += numbers[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line">sum1(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>);      <span class="comment">//7</span></span><br><span class="line">sum1(<span class="number">2</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">10</span>);  <span class="comment">//24</span></span><br></pre></td></tr></table></figure>

<p><strong>建议:</strong> 使用<code>...形参</code>的语法来处理函数参数不确定情况其编译为JavaScript代码后本质还是遍历arguments，所以其实这种情况，在设计的时候可以考虑让函数接收一个数组参数。</p>
<h3 id="泛型函数简单介绍"><a href="#泛型函数简单介绍" class="headerlink" title="泛型函数简单介绍"></a>泛型函数简单介绍</h3><p><strong>泛型说明</strong></p>
<p><strong>泛型编程</strong><code>是一种程序语言的编程风格，它允许开发者使用以后才会定义的类型，并在实例化的时候作为参数指定这些类型</code>。简而言之，当函数中某些参数或返回值的数据类型不确定时，使用泛型编程能够把数据类型作为一种参数传递进来。</p>
<p><strong>类型变量T</strong></p>
<p>我们先看一个简单的示例。</p>
<p>假设现在需要设计这样一个函数，它接收一个参数并返回任何传给它的值，参数的类型不指定。在实现这种设计需求的时候，因为函数参数的类型不指定，所以我们可能首先想到的就是使用any类型，给出下面的代码示例。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文件路径 ../08-泛型函数/01-泛型函数简单介绍.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//[001] 示例代码1</span></span><br><span class="line"><span class="comment">//说明 该函数接收一个string类型的参数，并返回传入的数据</span></span><br><span class="line"><span class="comment">//缺点 限定了函数的参数类型以及返回值类型必须是string</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">str:string</span>):<span class="title">string</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//wendingding.com</span></span><br><span class="line"><span class="built_in">console</span>.log(f1(<span class="string">&quot;wendingding.com&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//[002] 示例代码2</span></span><br><span class="line"><span class="comment">//说明 该函数接收一个任意类型的参数，并返回传入的数据</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params">arg:any</span>):<span class="title">any</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(f2(<span class="string">&quot;字符串测试&quot;</span>));   <span class="comment">//字符串测试</span></span><br><span class="line"><span class="built_in">console</span>.log(f2(<span class="number">123</span>));          <span class="comment">//123</span></span><br><span class="line"><span class="built_in">console</span>.log(f2(<span class="literal">true</span>));        <span class="comment">//true</span></span><br></pre></td></tr></table></figure>

<p>示例代码002解决了参数可以是任意类型的问题，但简单使用any类型并不足以表达<code>传入参数和返回值参数必须类型一致</code>这个要求，简单说<code>传入的类型与返回的类型应该是相同的</code>这个信息点丢失了或者说表现得不够明确。</p>
<p>因此，我们需要一种方法来明确的表示返回值的类型与传入参数的类型应该是相同的。下面的代码中，我们使用类型变量来设计一个泛型函数，类型变量是一种特殊的变量，只用于表示类型而不是值。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//[003] 示例代码3</span></span><br><span class="line"><span class="comment">//说明 该泛型函数使用类型变量T来表示接收参数和返回值的类型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f3</span>&lt;<span class="title">T</span>&gt;(<span class="params">arg:T</span>):<span class="title">T</span></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(f3&lt;string&gt;(<span class="string">&quot;字符串&quot;</span>));      <span class="comment">//字符串</span></span><br><span class="line"><span class="built_in">console</span>.log(f3&lt;number&gt;(<span class="number">345</span>));          <span class="comment">//345</span></span><br><span class="line"><span class="built_in">console</span>.log(f3&lt;boolean&gt;(<span class="literal">false</span>));        <span class="comment">//false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(f3(<span class="string">&quot;字符串-类型推导&quot;</span>));      <span class="comment">//字符串-类型推导</span></span><br><span class="line"><span class="built_in">console</span>.log(f3(<span class="number">123</span>));                 <span class="comment">//123</span></span><br><span class="line"><span class="built_in">console</span>.log(f3(<span class="literal">true</span>));                <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>代码中函数接收参数的类型以及返回值的类型我们使用T这个类型变量来表示，T表示的具体类型由函数调用时具体的实参类型决定。如果实参是字符串，那么T就是string类型，如果实参是布尔类型的值，比如true或者是false，那么T就是boolean类型的。</p>
<blockquote>
<p><strong>定义了泛型函数后，有两种调用方式</strong><br>❏  调用函数的时候，使用<code>&lt; &gt;</code>明确的传入T的类型。<br>❏  利用类型推导来确定T的类型。</p>
</blockquote>
<p><strong>泛型函数使用注意</strong></p>
<p>** 注意 ** <span style='color:red'>使用泛型函数的时候，编译器要求我们在函数体内必须正确的使用这个通用的类型。 换句话说，我们必须把这些参数当做是任意类型的数据来组织代码，否则可能会出现编译错误。</span></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文件路径 ../08-泛型函数/02-泛型函数使用注意点.ts</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//说明 该泛型函数使用类型变量T来表示接收参数和返回值的类型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>&lt;<span class="title">T</span>&gt;(<span class="params">arg:T</span>):<span class="title">T</span></span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;打印length值 = &quot;</span> + arg.length);</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//报错：error TS2339: Property &#x27;length&#x27; does not exist on type &#x27;T&#x27;.</span></span><br><span class="line"><span class="built_in">console</span>.log(fn([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]));            </span><br></pre></td></tr></table></figure>
<p>上面的代码在编译的时候，编译器报错<code>T类型</code>没有length这个属性。错误的原因在于我们在函数体中使用了arg的.length属性，但是却没有在任何地方指明arg具有这个属性。</p>
<p>类型变量(T)表示的是任意类型，而调用这个函数时传入实参可能是数字或true，它们并不具有.length属性。如果我们能够确定函数参数是数组类型的，而数组元素的类型不确定，那么可以像下面这样来组织代码。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//调整组织代码的方式[001]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>&lt;<span class="title">T</span>&gt;(<span class="params">arg:T[]</span>):<span class="title">T</span>[]</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;打印length值 = &quot;</span> + arg.length);</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(f1([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]));                    <span class="comment">//打印length值 = 3 [1,2,3]</span></span><br><span class="line"><span class="built_in">console</span>.log(f1([<span class="string">&quot;str1&quot;</span>,<span class="string">&quot;str2&quot;</span>,<span class="string">&quot;demo&quot;</span>]));     <span class="comment">//打印length值 = 3 [&quot;str1&quot;,&quot;str2&quot;,&quot;demo&quot;]</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//调整组织代码的方式[002]</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>&lt;<span class="title">T</span>&gt;(<span class="params">arg:<span class="built_in">Array</span>&lt;T&gt;</span>):<span class="title">Array</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">&quot;数组的长度为 = &quot;</span> + arg.length);</span><br><span class="line">  <span class="keyword">return</span> arg;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(f2([<span class="number">2</span>,<span class="number">4</span>,<span class="number">8</span>,<span class="number">16</span>]));                    <span class="comment">//打印length值 = 4 [2,4,8,16]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<div class='tip'>**提示** 使用泛型函数的时候千万不能先入为主想当然。</div>

<p>备注：该文章所有的示例代码均可以<a target="_blank" rel="noopener" href="https://github.com/flowerField/TypeScript-Demo">点击在Github托管仓库获取</a></p>
<hr>
<ul>
<li>Posted by 博客园·<a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a> | <a target="_blank" rel="noopener" href="http://wendingding.com/">花田半亩</a></li>
<li>联系作者 简书·<a target="_blank" rel="noopener" href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/06/24/TypeScript%E7%B3%BB%E5%88%97%20%5B06%5D-typeScript%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7(%E4%BA%94)/" class="prev">上一篇</a><a href="/2018/06/21/TypeScript%E7%B3%BB%E5%88%97%20%5B04%5D-typeScript%E8%AF%AD%E8%A8%80%E7%89%B9%E6%80%A7(%E4%B8%89)/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2022 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计 420.5k (字)</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>