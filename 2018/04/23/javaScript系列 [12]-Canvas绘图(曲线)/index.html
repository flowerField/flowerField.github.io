<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> javaScript系列 [12]-Canvas绘图(曲线) · 花田半亩</title><meta name="description" content="javaScript系列 [12]-Canvas绘图(曲线) - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="花田半亩" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/%E9%B2%B8%E9%B1%BC.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="https://github.com/flowerField" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">javaScript系列 [12]-Canvas绘图(曲线)</h1><div class="post-info">Apr 23, 2018<span class="post-count"></span> ✧ 字数统计:3.6k(字) &nbsp;&nbsp; ♨︎ 阅读时长:17(分钟)</div><div class="post-content"><div class='tip'>本文将介绍Canvas中的弧度、曲线、圆弧以及文字的绘制方法以及径向渐变等内容，并提供饼状图等综合案例。</div>

<h3 id="Canvas中的弧度、曲线和圆弧"><a href="#Canvas中的弧度、曲线和圆弧" class="headerlink" title="Canvas中的弧度、曲线和圆弧"></a>Canvas中的弧度、曲线和圆弧</h3><div class='titleX'>**专业术语**</div>

<img src='../../../../src/canvas_13.png'  width='500px'>
**`夹角`** 从一个点发射(延伸)出两条线段，两条线相交的部分会构成一个夹角。
**`角度`** 两条相交直线中的任何一条与另一条相叠合时必须转动的量的量度，单位符号为`°`。
**`周角`** 一条直线围绕起点需要与自己相叠合时必须转动的量的量度被称为周角，周角等分为`360`度。
**`弧度`** 角的度量单位，弧长等于半径的弧其所对的圆心角为1弧度(<span style='color:red'>弧长等于半径时，射线夹角为1弧度</span>)。

<div style='border:1px solid #888;width:300px;height:44px;line-height:44px;text-align:center;'>**公式 &nbsp;&nbsp;&nbsp;&nbsp; 弧度 = 角度 * π / 180**</div>

<p>在使用JavaScript编写代码进行相关计算的时候，经常需要使用Math提供的成员，这里简单说明。<br><img src='../../../../src/canvas_14.png'></p>
<p><strong><span style='color:red'>Math.PI</span></strong> 代表着<strong>π</strong>。</p>
<p><strong><span style='color:red'>Math.sin(弧度)</span></strong> 夹角对面的边 与 斜边的比值。<br><strong><span style='color:red'>Math.cos(弧度)</span></strong> 夹角侧面的边 与 斜边的比值。</p>
<p>这里给出圆形上点坐标的计算公式，其中<code>x0</code>和<code>y0</code>为圆心坐标，<code>rad</code>为弧度，<code>R</code>为圆的半径。</p>
<div style='border:1px solid #888;width:400px;height:44px;line-height:44px;text-align:center;margin-bottom:10px'>**坐标 &nbsp;&nbsp;&nbsp;&nbsp; ( x0 + Math.cos(rad) x R&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;&nbsp;&nbsp;&nbsp;y0 + Math.sin(rad) x R )**</div>

<div class='titleX'>**核心API介绍**</div>

<p><span style='border:1px solid #ccc;padding:2px 10px;color:#666'><strong>绘制圆弧</strong></span></p>
<p><strong><code>语法</code></strong> <code>ctx.arc(x,y,r,startAngle,endAngle,counterclockwise);</code><br><strong><code>作用</code></strong> 通过该方法来绘制圆弧或者(半)圆。<br><strong><code>参数</code></strong> </p>
<ul>
<li><span style='font-family:Georgia'>x 圆心X轴坐标</span></li>
<li><span style='font-family:Georgia'>y 圆心Y轴坐标</span></li>
<li><span style='font-family:Georgia'>r 圆的半径</span></li>
<li><span style='font-family:Georgia'>startAngle  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;开始弧度</span></li>
<li><span style='font-family:Georgia'>endAngle    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;结束弧度</span></li>
<li><span style='font-family:Georgia'>counterclockwise &nbsp;&nbsp;是否逆时针旋转(默认为false)</span></li>
</ul>
<p><span style='border:1px solid #ccc;padding:2px 10px;color:#666'><strong>绘制圆弧曲线</strong></span></p>
<p><strong><code>语法</code></strong> <code>ctx.arcTo(x1,y1,x2,y2,r);</code><br><strong><code>作用</code></strong> 参考两个点并根据指定半径来创建一条圆弧路径。<br><strong><code>备注</code></strong> 绘制的圆弧与当前点到第一个点的连线相切且与第一第二个点的连线也相切。<br><strong><code>说明</code></strong> <code>arcTo</code>方法的这些特性决定了该方法非常适合用来绘制圆角矩形。<br><strong><code>参数</code></strong> </p>
<ul>
<li><span style='font-family:Georgia'>x1 第一个参考点的X轴坐标</span></li>
<li><span style='font-family:Georgia'>y1 第一个参考点的Y轴坐标</span></li>
<li><span style='font-family:Georgia'>x2 第二个参考点的X轴坐标</span></li>
<li><span style='font-family:Georgia'>y3 第二个参考点的Y轴坐标</span></li>
<li><span style='font-family:Georgia'>r &nbsp;&nbsp;&nbsp;圆的半径</span></li>
</ul>
<p><span style='border:1px solid #ccc;padding:2px 10px;color:#666'><strong>圆形渐变</strong></span></p>
<p><strong><code>语法</code></strong> <code>ctx.createRadialGradient(x0,y0,r0,x1,y1,r1);;</code><br><strong><code>作用</code></strong> 通过该方法来绘制圆弧或者(半)圆。<br><strong><code>参数</code></strong> </p>
<ul>
<li><span style='font-family:Georgia'>x0 渐变开始圆的X轴坐标</span></li>
<li><span style='font-family:Georgia'>y0 渐变开始圆的Y轴坐标</span></li>
<li><span style='font-family:Georgia'>r0 开始圆的半径</span></li>
<li><span style='font-family:Georgia'>x1 渐变结束圆的X轴坐标</span></li>
<li><span style='font-family:Georgia'>y1 渐变结束圆的Y轴坐标</span></li>
<li><span style='font-family:Georgia'>r1 结束圆的半径</span></li>
</ul>
<h3 id="Canvas曲线-圆弧绘制示例"><a href="#Canvas曲线-圆弧绘制示例" class="headerlink" title="Canvas曲线-圆弧绘制示例"></a>Canvas曲线-圆弧绘制示例</h3><div class='titleX'>**数学方程绘制图形Demo1**</div>
<img src='../../../../src/canvas_17.png'  height="120px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas  = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx     = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//001 通过代数方程来绘制直线</span></span><br><span class="line"><span class="comment">//设置路径(起点)</span></span><br><span class="line">ctx.moveTo(<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> x = <span class="number">30</span>,y = <span class="number">0</span>; x &lt; <span class="number">1000</span> ; x++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//通过代数方程来绘制直线</span></span><br><span class="line">    y = x / <span class="number">2</span> * <span class="number">0.3</span>;</span><br><span class="line">    ctx.lineTo(x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//设置描边的颜色样式</span></span><br><span class="line">ctx.strokeStyle = <span class="string">&quot;#0Af&quot;</span>;</span><br><span class="line"><span class="comment">//描边绘制出图案</span></span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line"><span class="comment">//002 通过三角函数来绘制曲线(正玄/余弦)</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> x = <span class="number">30</span>,y = <span class="number">0</span>; x &lt; <span class="number">1000</span> ; x++)</span><br><span class="line">&#123;   </span><br><span class="line">    <span class="comment">// 高度 * 波长 + 中心轴位置</span></span><br><span class="line">    y = <span class="number">50</span> * <span class="built_in">Math</span>.sin(x/<span class="number">25</span>) + <span class="number">100</span>;</span><br><span class="line">    ctx.lineTo(x,y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//设置描边的颜色样式</span></span><br><span class="line">ctx.strokeStyle = <span class="string">&quot;red&quot;</span>;</span><br><span class="line"><span class="comment">//描边绘制出图案</span></span><br><span class="line">ctx.stroke();</span><br></pre></td></tr></table></figure>
<div class='titleX'>**数学方程绘制图形Demo2**</div>

<img src='../../../../src/canvas_20.png'  height="120px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas  = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx     = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">draw</span>(<span class="params">offsetX,n</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> dig = <span class="built_in">Math</span>.PI / <span class="number">15</span> * n;</span><br><span class="line">    ctx.beginPath();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; <span class="number">30</span> ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> x = <span class="built_in">Math</span>.sin(i * dig);</span><br><span class="line">        <span class="keyword">var</span> y = <span class="built_in">Math</span>.cos(i * dig);</span><br><span class="line">        ctx.lineTo(offsetX + x * <span class="number">80</span>,<span class="number">150</span> + y * <span class="number">80</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//闭合路径</span></span><br><span class="line">    ctx.closePath();</span><br><span class="line">    <span class="comment">//设置样式并填充</span></span><br><span class="line">    ctx.fillStyle = <span class="string">&quot;#fff&quot;</span>;</span><br><span class="line">    ctx.fill();</span><br><span class="line">    <span class="comment">//设置样式并描边</span></span><br><span class="line">    ctx.strokeStyle = <span class="string">&quot;#666&quot;</span>;</span><br><span class="line">    ctx.stroke();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> data = [<span class="number">14</span>,<span class="number">13</span>,<span class="number">19</span>,<span class="number">7</span>,<span class="number">26</span>];</span><br><span class="line">data.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">n,i</span>)</span>&#123;</span><br><span class="line">    draw((i + <span class="number">1</span>) * <span class="number">160</span>,n);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<div class='titleX'>**绘制相切曲线Demo**</div>
<img src='../../../../src/canvas_21.png'  height="120px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx    = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> x0 = <span class="number">100</span>,y0 = <span class="number">100</span>,</span><br><span class="line">    x1 = <span class="number">500</span>,y1 = <span class="number">100</span>,</span><br><span class="line">    x2 = <span class="number">450</span>,y2 = <span class="number">150</span>;</span><br><span class="line"></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(x0,y0);</span><br><span class="line">ctx.arcTo(x1,y1,x2,y2,<span class="number">30</span>);</span><br><span class="line">ctx.strokeStyle = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(x0,y0);</span><br><span class="line">ctx.lineTo(x1,y1);</span><br><span class="line">ctx.lineTo(x2,y2);</span><br><span class="line"></span><br><span class="line">ctx.fillText(<span class="string">&#x27;x0,y0&#x27;</span>,x0,y0+<span class="number">10</span>)</span><br><span class="line">ctx.fillText(<span class="string">&#x27;x1,y1&#x27;</span>,x1+<span class="number">10</span>,y1+<span class="number">10</span>)</span><br><span class="line">ctx.fillText(<span class="string">&#x27;x2,y2&#x27;</span>,x2+<span class="number">10</span>,y2)</span><br><span class="line">ctx.strokeStyle = <span class="string">&quot;#333&quot;</span>;</span><br><span class="line">ctx.stroke();</span><br></pre></td></tr></table></figure>
<div class='titleX'>**绘制圆角矩形Demo**</div>
<img src='../../../../src/canvas_22.png'  height="120px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx    = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawRoundedRect</span>(<span class="params">x,y,w,h,r,isFill,isStrokeRect</span>)</span>&#123;</span><br><span class="line">    ctx.beginPath();</span><br><span class="line">    ctx.moveTo( x + r , y );</span><br><span class="line">    ctx.arcTo(  x + w , y , x + w , y + h , r);</span><br><span class="line">    ctx.arcTo(  x + w , y + h , x , y + h , r);</span><br><span class="line">    ctx.arcTo(  x , y + h , x , y , r);</span><br><span class="line">    ctx.arcTo(  x , y ,  x + r , y , r);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(isFill) &#123;</span><br><span class="line">        ctx.fillStyle = getRandomColor();</span><br><span class="line">        ctx.fill();</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        ctx.strokeStyle = getRandomColor();</span><br><span class="line">        ctx.stroke();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(isStrokeRect)</span><br><span class="line">    &#123;</span><br><span class="line">        ctx.beginPath();</span><br><span class="line">        ctx.moveTo( x + r , y );</span><br><span class="line">        ctx.lineTo(x + w  , y );</span><br><span class="line">        ctx.lineTo(x + w  , y + h);</span><br><span class="line">        ctx.lineTo(x  , y + h);</span><br><span class="line">        ctx.lineTo(x  , y);</span><br><span class="line">        ctx.lineTo(x + r  , y);</span><br><span class="line"></span><br><span class="line">        ctx.fillStyle = <span class="string">&quot;#000&quot;</span>;</span><br><span class="line">        ctx.fillText(<span class="string">&quot;x0,y0&quot;</span>,x + r,y);</span><br><span class="line">        ctx.fillText(<span class="string">&quot;x1,y1&quot;</span>,x + w,y);</span><br><span class="line">        ctx.fillText(<span class="string">&quot;x2,y2&quot;</span>,x + w,y + h + <span class="number">10</span>);</span><br><span class="line">        ctx.fillText(<span class="string">&quot;x3,y3&quot;</span>,x-<span class="number">10</span>,y + h + <span class="number">10</span>);</span><br><span class="line">        ctx.fillText(<span class="string">&quot;x4,y4&quot;</span>,x - <span class="number">10</span>,y-<span class="number">10</span>);</span><br><span class="line">        ctx.fillText(<span class="string">&quot;x5,y5&quot;</span>,x + r,y + <span class="number">10</span>);</span><br><span class="line">        ctx.stroke();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">drawRoundedRect(<span class="number">50</span>,<span class="number">40</span>,<span class="number">100</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="literal">false</span>,<span class="literal">true</span>);</span><br><span class="line">drawRoundedRect(<span class="number">200</span>,<span class="number">40</span>,<span class="number">100</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="literal">true</span>,<span class="literal">false</span>);</span><br><span class="line">drawRoundedRect(<span class="number">350</span>,<span class="number">40</span>,<span class="number">100</span>,<span class="number">100</span>,<span class="number">10</span>,<span class="literal">true</span>);</span><br><span class="line">drawRoundedRect(<span class="number">500</span>,<span class="number">40</span>,<span class="number">100</span>,<span class="number">100</span>,<span class="number">20</span>);</span><br><span class="line">drawRoundedRect(<span class="number">650</span>,<span class="number">40</span>,<span class="number">120</span>,<span class="number">100</span>,<span class="number">30</span>,<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandomColor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r = getRandom();</span><br><span class="line">    <span class="keyword">var</span> g = getRandom();</span><br><span class="line">    <span class="keyword">var</span> b = getRandom();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;rgb(&quot;</span>+r+<span class="string">&quot;,&quot;</span>+g+<span class="string">&quot;,&quot;</span>+b+<span class="string">&quot;)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">256</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<div class='titleX'>**绘制弧线、扇形、圆弧和圆Demo**</div>
<img src='../../../../src/canvas_16.png'  height="120px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas  = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx     = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制弧线</span></span><br><span class="line">ctx.arc(<span class="number">100</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="number">3</span>/<span class="number">2</span> * <span class="built_in">Math</span>.PI,<span class="number">2</span> * <span class="built_in">Math</span>.PI,<span class="literal">false</span>);</span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制扇形</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(<span class="number">200</span>,<span class="number">100</span>);</span><br><span class="line">ctx.arc(<span class="number">200</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="number">3</span>/<span class="number">2</span> * <span class="built_in">Math</span>.PI,<span class="number">2</span> * <span class="built_in">Math</span>.PI,<span class="literal">false</span>);</span><br><span class="line">ctx.lineTo(<span class="number">200</span>,<span class="number">100</span>);</span><br><span class="line">ctx.strokeStyle = <span class="string">&quot;#f09&quot;</span>;</span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line"><span class="comment">//填充扇形</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(<span class="number">300</span>,<span class="number">100</span>);</span><br><span class="line">ctx.arc(<span class="number">300</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="number">3.2</span>/<span class="number">2</span> * <span class="built_in">Math</span>.PI,<span class="number">3.8</span>/<span class="number">2</span> * <span class="built_in">Math</span>.PI,<span class="literal">false</span>);</span><br><span class="line">ctx.lineTo(<span class="number">300</span>,<span class="number">100</span>);</span><br><span class="line">ctx.fillStyle = <span class="string">&quot;#195&quot;</span>;</span><br><span class="line">ctx.fill();</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制半圆</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.strokeStyle = <span class="string">&quot;#666&quot;</span>;</span><br><span class="line">ctx.arc(<span class="number">450</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="built_in">Math</span>.PI,<span class="number">2</span> * <span class="built_in">Math</span>.PI,<span class="literal">false</span>);</span><br><span class="line">ctx.closePath();</span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制圆形</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.strokeStyle = <span class="string">&quot;#000&quot;</span>;</span><br><span class="line">ctx.arc(<span class="number">570</span>,<span class="number">80</span>,<span class="number">40</span>,<span class="number">0</span>,<span class="number">2</span> * <span class="built_in">Math</span>.PI,<span class="literal">false</span>);</span><br><span class="line">ctx.stroke();</span><br></pre></td></tr></table></figure>
<div class='titleX'>**绘制五环图案Demo**</div>

<img src='../../../../src/canvas_15.png'  height="120px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas  = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx     = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> x = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">var</span> y = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">var</span> r = <span class="number">50</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; <span class="number">5</span> ; i++)</span><br><span class="line">&#123;   ctx.beginPath();</span><br><span class="line">    <span class="keyword">if</span>( i &gt;=<span class="number">3</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ctx.arc(x + (i * <span class="number">80</span>) -<span class="number">200</span>,y + <span class="number">60</span>,r,<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">Math</span>.PI,<span class="literal">false</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        ctx.arc(x + (i * <span class="number">80</span>),y,r,<span class="number">0</span>,<span class="number">2</span>*<span class="built_in">Math</span>.PI,<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ctx.strokeStyle = getRandomColor();</span><br><span class="line">    ctx.stroke();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandomColor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r = getRandom();</span><br><span class="line">    <span class="keyword">var</span> g = getRandom();</span><br><span class="line">    <span class="keyword">var</span> b = getRandom();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;rgb(&quot;</span>+r+<span class="string">&quot;,&quot;</span>+g+<span class="string">&quot;,&quot;</span>+b+<span class="string">&quot;)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">256</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<div class='titleX'>**绘制等分的圆Demo**</div>

<img src='../../../../src/canvas_18.png'  height="140px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas  = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx     = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//描边</span></span><br><span class="line">drawCircle(<span class="number">100</span>,<span class="number">100</span>,<span class="number">40</span>,<span class="number">2</span>,<span class="literal">true</span>);</span><br><span class="line">drawCircle(<span class="number">200</span>,<span class="number">100</span>,<span class="number">40</span>,<span class="number">3</span>,<span class="literal">true</span>);</span><br><span class="line">drawCircle(<span class="number">300</span>,<span class="number">100</span>,<span class="number">40</span>,<span class="number">4</span>,<span class="literal">true</span>);</span><br><span class="line">drawCircle(<span class="number">400</span>,<span class="number">100</span>,<span class="number">40</span>,<span class="number">20</span>,<span class="literal">true</span>);</span><br><span class="line">drawCircle(<span class="number">500</span>,<span class="number">100</span>,<span class="number">40</span>,<span class="number">100</span>,<span class="literal">true</span>);</span><br><span class="line">drawCircle(<span class="number">600</span>,<span class="number">100</span>,<span class="number">40</span>,<span class="number">200</span>,<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//填充</span></span><br><span class="line">drawCircle(<span class="number">100</span>,<span class="number">200</span>,<span class="number">40</span>,<span class="number">2</span>);</span><br><span class="line">drawCircle(<span class="number">200</span>,<span class="number">200</span>,<span class="number">40</span>,<span class="number">3</span>);</span><br><span class="line">drawCircle(<span class="number">300</span>,<span class="number">200</span>,<span class="number">40</span>,<span class="number">4</span>);</span><br><span class="line">drawCircle(<span class="number">400</span>,<span class="number">200</span>,<span class="number">40</span>,<span class="number">20</span>);</span><br><span class="line">drawCircle(<span class="number">500</span>,<span class="number">200</span>,<span class="number">40</span>,<span class="number">100</span>);</span><br><span class="line">drawCircle(<span class="number">600</span>,<span class="number">200</span>,<span class="number">40</span>,<span class="number">200</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawCircle</span>(<span class="params">x,y,r,n,isStroke</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span>  i = <span class="number">0</span> ; i &lt; n ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//计算开始和结束的角度</span></span><br><span class="line">        <span class="keyword">var</span> angle = <span class="number">2</span> * <span class="built_in">Math</span>.PI / n;</span><br><span class="line">        <span class="keyword">var</span> startAngle  = angle * i;</span><br><span class="line">        <span class="keyword">var</span> endAngle    = angle * (i + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//开始路径</span></span><br><span class="line">        ctx.beginPath();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//设置绘制圆的起点</span></span><br><span class="line">        ctx.moveTo(x,y);</span><br><span class="line">        ctx.arc(x,y,r,startAngle,endAngle,<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(isStroke)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ctx.strokeStyle = getRandomColor();</span></span><br><span class="line">            ctx.stroke();</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            ctx.fillStyle = getRandomColor();</span><br><span class="line">            ctx.fill();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//获取填充的颜色/随机</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandomColor</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> r = getRandom();</span><br><span class="line">    <span class="keyword">var</span> g = getRandom();</span><br><span class="line">    <span class="keyword">var</span> b = getRandom();</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;rgb(&quot;</span>+r+<span class="string">&quot;,&quot;</span>+g+<span class="string">&quot;,&quot;</span>+b+<span class="string">&quot;)&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRandom</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">256</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<div class='titleX'>**绘制饼状图综合示例**</div>

<img src='../../../../src/canvas_19.png'  height="140px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">PieChart</span> (<span class="params">ctx</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.ctx        = ctx || <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>).getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">    <span class="built_in">this</span>.x          = <span class="built_in">this</span>.ctx.canvas.width/<span class="number">2</span> - <span class="number">30</span>;</span><br><span class="line">    <span class="built_in">this</span>.y          = <span class="built_in">this</span>.ctx.canvas.height/<span class="number">2</span>;</span><br><span class="line">    <span class="built_in">this</span>.r          = <span class="number">120</span>;</span><br><span class="line">    <span class="built_in">this</span>.outLine    = <span class="number">20</span>;</span><br><span class="line">    <span class="built_in">this</span>.dataList   = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">PieChart.prototype = &#123;</span><br><span class="line">    <span class="attr">constructor</span>:PieChart,</span><br><span class="line">    <span class="attr">init</span>:<span class="function"><span class="keyword">function</span>(<span class="params">dataList</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.dataList = dataList || [&#123;<span class="attr">title</span>:<span class="string">&quot;默认&quot;</span>,<span class="attr">value</span>:<span class="number">100</span>&#125;];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//根据数据来计算并转换弧度</span></span><br><span class="line">        <span class="built_in">this</span>.transformAngle();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绘制饼状图</span></span><br><span class="line">        <span class="built_in">this</span>.drawPie();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">drawPie</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> startAngle = <span class="number">0</span>,endAngle;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; <span class="built_in">this</span>.dataList.length ; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">var</span> item = <span class="built_in">this</span>.dataList[i];</span><br><span class="line">            endAngle = startAngle + item.angle;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">this</span>.ctx.beginPath();</span><br><span class="line">            <span class="built_in">this</span>.ctx.moveTo(<span class="built_in">this</span>.x,<span class="built_in">this</span>.y);</span><br><span class="line">            <span class="built_in">this</span>.ctx.arc(<span class="built_in">this</span>.x,<span class="built_in">this</span>.y,<span class="built_in">this</span>.r,startAngle,endAngle,<span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">var</span> color= <span class="built_in">this</span>.ctx.strokeStyle= <span class="built_in">this</span>.ctx.fillStyle= <span class="built_in">this</span>.getRandomColor();</span><br><span class="line">            <span class="built_in">this</span>.ctx.stroke();</span><br><span class="line">            <span class="built_in">this</span>.ctx.fill();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//绘制标题</span></span><br><span class="line">            <span class="built_in">this</span>.drawPieTitle(startAngle,item.angle,color,item.title)</span><br><span class="line"></span><br><span class="line">            <span class="comment">//绘制图例</span></span><br><span class="line">            <span class="built_in">this</span>.drawPieLegend(i,item.title);</span><br><span class="line">            startAngle = endAngle;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">drawPieTitle</span>:<span class="function"><span class="keyword">function</span>(<span class="params">startAngle,angle,color,title</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> edge    = <span class="built_in">this</span>.r + <span class="built_in">this</span>.outLine;</span><br><span class="line">        <span class="keyword">var</span> edgeX   = <span class="built_in">Math</span>.cos(startAngle + angle / <span class="number">2</span>) * edge; <span class="comment">/*x轴方向的直角边*/</span></span><br><span class="line">        <span class="keyword">var</span> edgeY   = <span class="built_in">Math</span>.sin(startAngle + angle / <span class="number">2</span>) * edge; <span class="comment">/*y轴方向的直角边*/</span></span><br><span class="line">        <span class="keyword">var</span> outX    = <span class="built_in">this</span>.x + edgeX;                          <span class="comment">/*计算延伸出去的点坐标*/</span></span><br><span class="line">        <span class="keyword">var</span> outY    = <span class="built_in">this</span>.y + edgeY;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//画出坐标点</span></span><br><span class="line">        <span class="built_in">this</span>.ctx.beginPath();</span><br><span class="line">        <span class="built_in">this</span>.ctx.moveTo(<span class="built_in">this</span>.x,<span class="built_in">this</span>.y);</span><br><span class="line">        <span class="built_in">this</span>.ctx.lineTo(outX,outY);</span><br><span class="line">        <span class="built_in">this</span>.ctx.strokeStyle = color;</span><br><span class="line">        <span class="built_in">this</span>.ctx.stroke();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绘制文字下划线</span></span><br><span class="line">        <span class="keyword">var</span> textWidth   = <span class="built_in">this</span>.ctx.measureText(title).width + <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">var</span> lineX       = outX &gt; <span class="built_in">this</span>.x ? outX + textWidth : outX - textWidth;</span><br><span class="line">        <span class="built_in">this</span>.ctx.lineTo(lineX,outY);</span><br><span class="line">        <span class="built_in">this</span>.ctx.stroke();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//绘制文字</span></span><br><span class="line">        <span class="built_in">this</span>.ctx.font           = <span class="string">&quot;15px KaiTi&quot;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ctx.textAlign      = outX &gt; <span class="built_in">this</span>.x ? <span class="string">&quot;left&quot;</span> : <span class="string">&quot;right&quot;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ctx.textBaseline   = <span class="string">&quot;bottom&quot;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ctx.fillText(title,outX,outY);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">drawPieLegend</span>:<span class="function"><span class="keyword">function</span>(<span class="params">index,title</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//在计算的时候最好的能够反着计算</span></span><br><span class="line">        <span class="keyword">var</span> space = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">var</span> rectW = <span class="number">40</span>;</span><br><span class="line">        <span class="keyword">var</span> rectH = <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">var</span> rectX = <span class="built_in">this</span>.x + <span class="built_in">this</span>.r + <span class="number">80</span>;</span><br><span class="line">        <span class="keyword">var</span> rectY = <span class="built_in">this</span>.y + (index * <span class="number">30</span>);</span><br><span class="line">        <span class="comment">//绘制矩形</span></span><br><span class="line">        <span class="built_in">this</span>.ctx.fillRect(rectX,rectY,rectW,rectH);</span><br><span class="line">        <span class="comment">// this.ctx.beginPath();</span></span><br><span class="line">        <span class="comment">// 绘制文字</span></span><br><span class="line">        <span class="built_in">this</span>.ctx.textAlign      = <span class="string">&#x27;left&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ctx.textBaseline   = <span class="string">&#x27;top&#x27;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ctx.fillStyle      = <span class="string">&quot;#000&quot;</span>;</span><br><span class="line">        <span class="built_in">this</span>.ctx.fillText(title,rectX + rectW + space,rectY);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getRandomColor</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> r = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">256</span>);</span><br><span class="line">        <span class="keyword">var</span> g = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">256</span>);</span><br><span class="line">        <span class="keyword">var</span> b = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">256</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;rgb(&#x27;</span>+r+<span class="string">&#x27;,&#x27;</span>+g+<span class="string">&#x27;,&#x27;</span>+b+<span class="string">&#x27;)&#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">transformAngle</span>:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> self    = <span class="built_in">this</span>;</span><br><span class="line">        <span class="keyword">var</span> total   = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.dataList.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item,i</span>)</span>&#123;</span><br><span class="line">            total += item.value;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">this</span>.dataList.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item,i</span>)</span>&#123;</span><br><span class="line">            self.dataList[i].angle = <span class="number">2</span> * <span class="built_in">Math</span>.PI * item.value/total;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span>  data = [&#123;<span class="attr">value</span>:<span class="number">20</span>,<span class="attr">title</span>:<span class="string">&quot;UI&quot;</span>&#125;,&#123;<span class="attr">value</span>:<span class="number">26</span>,<span class="attr">title</span>:<span class="string">&quot;java&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="attr">value</span>:<span class="number">20</span>,<span class="attr">title</span>:<span class="string">&quot;iOS&quot;</span>&#125;,&#123;<span class="attr">value</span>:<span class="number">63</span>,<span class="attr">title</span>:<span class="string">&quot;H5&quot;</span>&#125;,&#123;<span class="attr">value</span>:<span class="number">25</span>,<span class="attr">title</span>:<span class="string">&quot;Node&quot;</span>&#125;]</span><br><span class="line"><span class="keyword">var</span>  pie  = <span class="keyword">new</span> PieChart().init(data);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Canvas中的贝塞尔曲线"><a href="#Canvas中的贝塞尔曲线" class="headerlink" title="Canvas中的贝塞尔曲线"></a>Canvas中的贝塞尔曲线</h3><p><a href="">贝塞尔曲线</a>(<code>Bézier curve</code>)，最初由法国物理学家和数学家<code>Paul de Casteljau</code>发明，1962年被法国工程师皮埃尔·贝塞尔（<code>Pierre Bézier</code>）广泛发表并运用在汽车的车身设计上，现在多应用在计算机图形系统中。</p>
<p><a href="">贝塞尔曲线</a>分为平方(<code>quadratic</code>)贝塞尔曲线和立方(<code>cubic</code>)贝塞尔曲线两其中平方贝塞尔曲线是一种二次曲线，由两个锚点和一个控制点总共三个点来定义，而立方贝塞尔曲线是一种三次曲线，由两个锚点和两个控制点共四个点来定义。它们的区别在于立方贝塞尔曲线能够在两个方向上弯曲。</p>
<p><a href="">Canvas</a>支持两种贝塞尔曲线，分别由<code>quadraticCurveTo</code>和<code>bezierCurveTo</code>方法来实现。</p>
<p><span style='border:1px solid #ccc;padding:2px 10px;color:#666'><strong>二次贝塞尔曲线</strong></span></p>
<p><strong><code>语法</code></strong> <code>ctx.quadraticCurveTo(x0,y0,x1,y1);;</code><br><strong><code>作用</code></strong> 通过使用表示二次贝塞尔曲线的指定控制点，向当前路径添加一个点绘制曲线。<br><strong><code>参数</code></strong> </p>
<ul>
<li><span style='font-family:Georgia'>x0 控制点的X轴坐标</span></li>
<li><span style='font-family:Georgia'>y0 控制点的Y轴坐标</span></li>
<li><span style='font-family:Georgia'>x1 结束点(锚点)的X轴坐标</span></li>
<li><span style='font-family:Georgia'>y1 结束点(锚点)的Y轴坐标</span></li>
</ul>
<p><strong><code>说明</code></strong> 二次贝塞尔曲线需要两个点。分别是用于二次贝塞尔计算中的控制点和曲线的结束点。<br><strong><code>注意</code></strong> 曲线还需要一个开始点(路径最后的点)如果路径不存在，那么可以使用<code>moveTo() </code>方法来定义。</p>
<p><span style='border:1px solid #ccc;padding:2px 10px;color:#666'><strong>三次贝塞尔曲线</strong></span></p>
<p><strong><code>语法</code></strong> <code>ctx.bezierCurveTo(x0,y0,x1,y1,x2,y2);;</code><br><strong><code>作用</code></strong> 通过使用表示二次贝塞尔曲线的指定控制点，向当前路径添加一个点绘制曲线。<br><strong><code>参数</code></strong> </p>
<ul>
<li><span style='font-family:Georgia'>x0 第一个控制点的X轴坐标</span></li>
<li><span style='font-family:Georgia'>y0 第一个控制点的Y轴坐标</span></li>
<li><span style='font-family:Georgia'>x1 第二个控制点的X轴坐标</span></li>
<li><span style='font-family:Georgia'>y1 第二个控制点的Y轴坐标</span></li>
<li><span style='font-family:Georgia'>x2 结束点(锚点)的X轴坐标</span></li>
<li><span style='font-family:Georgia'>y2 结束点(锚点)的Y轴坐标</span></li>
</ul>
<p><strong><code>说明</code></strong> 三次贝塞尔曲线需要三个点，两个控制点和一个锚点。<br><strong><code>注意</code></strong> 曲线还需要一个开始点(路径最后的点)如果路径不存在，那么可以使用<code>moveTo() </code>方法来定义。</p>
<h3 id="Canvas贝塞尔曲线绘制示例"><a href="#Canvas贝塞尔曲线绘制示例" class="headerlink" title="Canvas贝塞尔曲线绘制示例"></a>Canvas贝塞尔曲线绘制示例</h3><div class='titleX'>**二次贝塞尔曲线示例Demo**</div>

<img src='../../../../src/canvas_24.png'  height="150px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx    = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置曲线的起点(当前路径的最后点没有则通过moveTo设置)</span></span><br><span class="line">ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">ctx.quadraticCurveTo(<span class="number">100</span>,<span class="number">300</span>,<span class="number">500</span>,<span class="number">200</span>);</span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制文字</span></span><br><span class="line"><span class="keyword">var</span> margin = <span class="number">15</span>;</span><br><span class="line">ctx.fillText(<span class="string">&quot;(100,100)&quot;</span>,<span class="number">100</span> - margin,<span class="number">100</span> - margin);</span><br><span class="line">ctx.fillText(<span class="string">&quot;(100,300)&quot;</span>,<span class="number">100</span> - margin,<span class="number">300</span> + margin);</span><br><span class="line">ctx.fillText(<span class="string">&quot;(500,200)&quot;</span>,<span class="number">500</span> - margin,<span class="number">200</span> + margin);</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制线条</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">ctx.lineTo(<span class="number">100</span>,<span class="number">300</span>);</span><br><span class="line">ctx.lineTo(<span class="number">500</span>,<span class="number">200</span>);</span><br><span class="line">ctx.strokeStyle = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制点</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.arc(<span class="number">100</span>,<span class="number">100</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span> * <span class="built_in">Math</span>.PI);</span><br><span class="line">ctx.arc(<span class="number">100</span>,<span class="number">300</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span> * <span class="built_in">Math</span>.PI);</span><br><span class="line">ctx.fill();</span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.arc(<span class="number">500</span>,<span class="number">200</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span> * <span class="built_in">Math</span>.PI);</span><br><span class="line">ctx.fill();</span><br></pre></td></tr></table></figure>
<div class='titleX'>**三次贝塞尔曲线示例Demo**</div>

<img src='../../../../src/canvas_25.png'  height="200px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx    = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//设置曲线的起点(当前路径的最后点没有则通过moveTo设置)</span></span><br><span class="line">ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">ctx.bezierCurveTo(<span class="number">100</span>,<span class="number">300</span>,<span class="number">300</span>,<span class="number">50</span>,<span class="number">500</span>,<span class="number">200</span>);</span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制文字</span></span><br><span class="line"><span class="keyword">var</span> margin = <span class="number">15</span>;</span><br><span class="line">ctx.fillText(<span class="string">&quot;起点 (100,100)&quot;</span>,<span class="number">100</span> - margin,<span class="number">100</span> - margin);</span><br><span class="line">ctx.fillText(<span class="string">&quot;控制点 (100,300)&quot;</span>,<span class="number">100</span> - margin,<span class="number">300</span> + margin);</span><br><span class="line">ctx.fillText(<span class="string">&quot;(300,50)&quot;</span>,<span class="number">300</span> - margin,<span class="number">50</span> - margin);</span><br><span class="line">ctx.fillText(<span class="string">&quot;(500,200)&quot;</span>,<span class="number">500</span> - margin,<span class="number">200</span> + margin);</span><br><span class="line"><span class="comment">//绘制线条</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">ctx.lineTo(<span class="number">100</span>,<span class="number">300</span>);</span><br><span class="line">ctx.lineTo(<span class="number">300</span>,<span class="number">50</span>);</span><br><span class="line">ctx.lineTo(<span class="number">500</span>,<span class="number">200</span>);</span><br><span class="line">ctx.strokeStyle = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">ctx.stroke();</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制点</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.arc(<span class="number">100</span>,<span class="number">100</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span> * <span class="built_in">Math</span>.PI);</span><br><span class="line">ctx.arc(<span class="number">100</span>,<span class="number">300</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span> * <span class="built_in">Math</span>.PI);</span><br><span class="line">ctx.fill();</span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.arc(<span class="number">300</span>,<span class="number">50</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span> * <span class="built_in">Math</span>.PI);</span><br><span class="line">ctx.arc(<span class="number">500</span>,<span class="number">200</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span> * <span class="built_in">Math</span>.PI);</span><br><span class="line">ctx.fill();</span><br></pre></td></tr></table></figure>

<div class='titleX'>**贝塞尔曲线复杂图形示例Demo**</div>

<img src='../../../../src/canvas_26.png'  height="150px">

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> ctx = canvas.getContext(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//绘制贝塞尔曲线</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawBezierCurve</span>(<span class="params">dx,dy,n</span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> s = <span class="number">120</span>;</span><br><span class="line">    <span class="keyword">var</span> x0,x1,x3,y1,y2,y3;</span><br><span class="line">    <span class="keyword">var</span> dig = <span class="built_in">Math</span>.PI / <span class="number">15</span> * n;</span><br><span class="line"></span><br><span class="line">    ctx.beginPath();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i &lt; <span class="number">30</span> ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span>  X = <span class="built_in">Math</span>.sin(i * dig);</span><br><span class="line">        <span class="keyword">var</span>  Y = <span class="built_in">Math</span>.cos(i * dig);</span><br><span class="line">        x0 = dx + X * s;</span><br><span class="line">        x1 = dx + X * s + <span class="number">100</span>;</span><br><span class="line">        x2 = dx + X * s;</span><br><span class="line"></span><br><span class="line">        y0 = dy + Y * s - <span class="number">100</span>;</span><br><span class="line">        y1 = dy + Y * s;</span><br><span class="line">        y2 = dy + Y * s;</span><br><span class="line">        ctx.bezierCurveTo(x0 , y0 , x1 , y1 , x2 , y2);</span><br><span class="line">    &#125;</span><br><span class="line">    ctx.closePath();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//绘制和填充</span></span><br><span class="line">    ctx.fillStyle   = <span class="string">&quot;#eee&quot;</span>;</span><br><span class="line">    ctx.strokeStyle = <span class="string">&quot;red&quot;</span>;</span><br><span class="line">    ctx.fill();</span><br><span class="line">    ctx.stroke();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">drawBezierCurve(<span class="number">150</span>,<span class="number">250</span>,<span class="number">13</span>);</span><br><span class="line">drawBezierCurve(<span class="number">480</span>,<span class="number">250</span>,<span class="number">24</span>);</span><br><span class="line">drawBezierCurve(<span class="number">820</span>,<span class="number">250</span>,<span class="number">31</span>);</span><br></pre></td></tr></table></figure>

<img src='../../../../z.png' width="200px">

<hr>
<ul>
<li>Posted by 博客园·<a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a> | <a target="_blank" rel="noopener" href="http://wendingding.com/">花田半亩</a></li>
<li>联系作者 简书·<a target="_blank" rel="noopener" href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/04/24/javaScript%E7%B3%BB%E5%88%97%20%5B13%5D-Canvas%E7%BB%98%E5%9B%BE(%E6%96%87%E6%9C%AC)/" class="prev">上一篇</a><a href="/2018/04/22/javaScript%E7%B3%BB%E5%88%97%20%5B11%5D-Canvas%E7%BB%98%E5%9B%BE(%E8%B7%AF%E5%BE%84)/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2022 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计 418.8k (字)</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>