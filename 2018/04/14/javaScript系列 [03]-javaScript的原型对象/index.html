<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> javaScript系列 [03]-javaScript原型对象 · 花田半亩</title><meta name="description" content="javaScript系列 [03]-javaScript原型对象 - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="花田半亩" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="https://github.com/flowerField" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">javaScript系列 [03]-javaScript原型对象</h1><div class="post-info">Apr 14, 2018<span class="post-count"></span> ✧ 字数统计:1.9k(字) &nbsp;&nbsp; ♨︎ 阅读时长:7(分钟)</div><div class="post-content"><blockquote>
<p>引用： javaScript是一门基于原型的语言，它允许对象通过原型链引用另一个对象来构建对象中的复杂性，JavaScript使用原型链这种机制来实现动态代理。当试图去引用某一个属性时，它会遍历整个原型链，直到最后的节点。<a target="_blank" rel="noopener" href="https://book.douban.com/subject/26583722/">JavaScript专家编程·P24</a></p>
</blockquote>
<h4 id="1-1-原型对象说明"><a href="#1-1-原型对象说明" class="headerlink" title="1.1  原型对象说明"></a>1.1  原型对象说明</h4><p>在JavaScript中除了基本数据类型外的其它数据都是对象类型，包括对象、函数、数组等,它们跟原型对象密不可分。</p>
<p>JavaScript语言中有一个非常重要的概念，叫做<code>原型对象</code>，理解原型对象是进一步理解这门语言的基础，因为它是一门基于原型的语言，也因为所有的代码几乎都和原型对象有关，接下来我们先了解下原型对象是什么。</p>
<p><strong>原型对象</strong></p>
<p>在上一篇文章<a target="_blank" rel="noopener" href="http://wendingding.cn/2018/04/13/javaScript%E7%B3%BB%E5%88%97%20[02]-%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAjavaScript%E4%B8%AD%E7%9A%84%E5%AF%B9%E8%B1%A1/">JavaScript系列 [02]-javaScript对象探析</a>中，我们介绍了使用自定义构造函数创建对象的方式，<span style='color:red'>在构造函数被创建出来的时候，系统会默认帮构造函数创建并关联一个Object类型的新对象，我们称该对象就是这个构造函数的原型对象，构造函数的原型对象默认是一个空对象。</p>
<h4 id="1-2-原型对象的性质"><a href="#1-2-原型对象的性质" class="headerlink" title="1.2  原型对象的性质"></a>1.2  原型对象的性质</h4><p>构造函数相关联的原型对象的成员（属性和方法），可以被使用该构造函数创建出来的对象访问，即以自定义构造函数方式创建出来的所有实例对象，都自动拥有和共享该构造函数原型对象中的所有属性和方法(<code>想一想为什么空对象可以使用toString方法，所有的数组都可以使用push等方法</code>)。</p>
<p>代码示例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//01 声明构造函数Person</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//02 打印构造函数相关联的原型对象</span></span><br><span class="line"><span class="built_in">console</span>.log(Person.prototype);  <span class="comment">//Objec类型的空对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//03 给构造函数原型对象添加方法</span></span><br><span class="line">Person.prototype.showName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//04 使用构造函数创建实例对象</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(<span class="string">&quot;文顶顶&quot;</span>);</span><br><span class="line">p.showName();       <span class="comment">//文顶顶</span></span><br><span class="line"><span class="built_in">console</span>.log(p);</span><br></pre></td></tr></table></figure>
<p>代码说明</p>
<blockquote>
<p>☞ 上面的代码先提供了Person构造函数，该函数声明后，我们通过Person.prototype访问其原型对象打印得到一个Object类型的空对象，说明所有的构造函数创建后默认拥有prototype属性，即构造函数默认有一个相关联的原型对象（Object类型空对象）。</p>
</blockquote>
<blockquote>
<p>☞ 随后我们通过对象的动态特性给Person的原型对象添加了showName方法，通过打印结果可以验证构造函数的实例化对象(p)可以访问其原型对象上面的成员。</p>
</blockquote>
<p>通过对代码和其运行结果分析，我们不难得出构造函数（Person）、原型对象(Person.prototype)、实例对象（p）之间的关系图，如下。</p>
<img src='../../../../src/js_05.png'>

<p><code>代码说明</code></p>
<blockquote>
<p><strong>① 实例对象p由Person构造函数实例化而来。</strong></p>
</blockquote>
<blockquote>
<p><strong>② Person构造函数可以通过prototype属性访问其原型对象。</strong></p>
</blockquote>
<blockquote>
<p><strong>③ 实例对象p可以通过__proto__属性访问其构造函数的原型对象</strong>（可以简称为p的原型对象，我们在说原型对象的时候，应该先确定主语是构造函数还是实例对象，如果主语是构造函数，那么指的是构造函数.prototype，如果主语是实例对象，那么指的是创建该实例对象的构造函数相关联的原型对象，表示为实例对象.__proto__）。</p>
</blockquote>
<blockquote>
<p><strong>④ 原型对象（Person.prototype）可以通过constructor(构造器)属性来访问其关联的构造函数，无法访问实例对象。</strong></p>
</blockquote>
<p>下面贴出上面代码更详细的原型结构关系图。</p>
<img src='../../../../src/js_06.png'>

<p><strong>原型对象的访问</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//获取原型对象的方式</span></span><br><span class="line"><span class="comment">//01 构造函数访问原型对象：构造函数.prototype</span></span><br><span class="line"><span class="built_in">console</span>.log(Person.prototype);</span><br><span class="line"><span class="comment">//02 构造函数的实例对象访问原型对象：实例对象.__proto__</span></span><br><span class="line"><span class="built_in">console</span>.log(p.__proto__);</span><br><span class="line"><span class="built_in">console</span>.log(p.__proto__ == Person.prototype);</span><br><span class="line"><span class="comment">//03 通过Object.getPrototypeOf方法传递实例对象作为参数访问</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(p));</span><br></pre></td></tr></table></figure>
<p>总结一下，原型对象的访问方式如下</p>
<pre style='color:red'>
① 构造函数.prototype
② 实例对象.__proto__
③ Object.getPrototypeOf(实例对象)
</pre>

<p><strong>原型对象总结</strong></p>
<blockquote>
<p>❐  <strong>所有的对象都拥有<code>__proto__</code>属性，函数既拥有prototype属性又拥有<code>__proto__</code>属性。</strong><br>❐  对象的<code>__proto__</code>属性指向其构造函数相关联的原型对象（<code>函数的__proto__属性也一样，指向其构造函数Function相关的原型对象，是一个空函数</code>）。<br>❐  函数的prototype属性指向默认相关联的原型对象（函数和构造函数本质无差别）。</p>
</blockquote>
<div class='tip'>
 `__proto__`是一个非标准属性，即ECMAScript中并不包含该属性，这只是某些浏览器为了方便开发人员开发和调试而提供的一个属性，不具备通用性。建议在调试的时候可以使用该属性,但不能出现在正式的代码中，开发中可以使用Object.getPrototypeOf方法来替代。
<div>

<h4 id="1-3-设置原型对象"><a href="#1-3-设置原型对象" class="headerlink" title="1.3  设置原型对象"></a>1.3  设置原型对象</h4><p>所谓设置原型对象就是给构造函数的原型对象添加成员（属性和方法），具体的方式有两种</p>
<blockquote>
<p>① 利用对象的动态特性设置<br>② 替换原有的原型对象</p>
</blockquote>
<p>代码示例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//01 声明构造函数Person</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.age = age || <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//02 给构造函数原型对象添加方法</span></span><br><span class="line"><span class="comment">//设置原型对象的第一种方法</span></span><br><span class="line">Person.prototype.showName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;姓名 &quot;</span>+<span class="built_in">this</span>.name);</span><br><span class="line">&#125;;</span><br><span class="line">Person.prototype.showAge = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">&quot;年龄 &quot;</span>+<span class="built_in">this</span>.age);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//04 使用构造函数创建实例对象</span></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">&quot;文顶顶&quot;</span>);</span><br><span class="line">p1.showName();       <span class="comment">//姓名 文顶顶</span></span><br><span class="line">p1.showAge();        <span class="comment">//年龄 18</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> Person(<span class="string">&quot;章飞一绝&quot;</span>,<span class="number">99</span>);</span><br><span class="line">p2.showName();       <span class="comment">//姓名 章飞一绝</span></span><br><span class="line">p2.showAge();        <span class="comment">//年龄 99</span></span><br></pre></td></tr></table></figure>
<p>像上面代码这样直接利用对象的动态特性来设置原型对象，在原有原型对象的基础上添加属性和方法非常简单，但是如果要添加的方法或属性比较多，那么冗余代码会比较多，这种情况推荐直接替换原有的原型对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//01 声明构造函数Person</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name;</span><br><span class="line">    <span class="built_in">this</span>.age = age || <span class="number">18</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//02 给构造函数原型对象添加方法</span></span><br><span class="line"><span class="comment">//设置原型对象的第二种方法：直接替换原先的原型对象</span></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    <span class="attr">constructor</span>:Person,</span><br><span class="line">    <span class="attr">showName</span>:<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;姓名 &quot;</span>+<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">showAge</span>:<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">&quot;年龄 &quot;</span>+<span class="built_in">this</span>.age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//04 使用构造函数创建实例对象</span></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(<span class="string">&quot;文顶顶&quot;</span>);</span><br><span class="line">p.showName();       <span class="comment">//姓名 文顶顶</span></span><br><span class="line">p.showAge();        <span class="comment">//年龄 18</span></span><br><span class="line"><span class="built_in">console</span>.log(p.constructor); <span class="comment">//Person函数</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>注意</code> 如果是直接替换原型对象，那么需要修正构造器属性，让constructor指向构造函数。<br><code>说明</code> 因为替换的时候其实是用字面量的方式重新创建了新的对象，该对象作为Object构造函数的原型对象，内部没有constructor属性。这个时候如果要通过实例对象（比如p）的构造器属性判断其类型，那么会先在p身上找，没有则查找原型对象发现也没有，最终得到的Object.prototype身上的构造器属性，结果为Object 。</p>
<img src='../../../../z.png' width="200px">

<hr>
<ul>
<li>Posted by 博客园·<a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a> | <a target="_blank" rel="noopener" href="http://wendingding.com/">花田半亩</a></li>
<li>联系作者 简书·<a target="_blank" rel="noopener" href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/04/15/javaScript%E7%B3%BB%E5%88%97%20%5B04%5D-javaScript%E7%9A%84%E5%8E%9F%E5%9E%8B%E9%93%BE/" class="prev">上一篇</a><a href="/2018/04/13/javaScript%E7%B3%BB%E5%88%97%20%5B02%5D-%E6%B7%B1%E5%85%A5%E6%B5%85%E5%87%BAjavaScript%E4%B8%AD%E7%9A%84%E5%AF%B9%E8%B1%A1/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2022 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计 418.8k (字)</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>