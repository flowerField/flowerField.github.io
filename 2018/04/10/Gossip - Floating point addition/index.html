<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Gossip - Floating point addition · 花田半亩</title><meta name="description" content="Gossip - Floating point addition - 文顶顶"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/logo.jpeg"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://weibo.com/u/3800117445/atom.xml" title="花田半亩"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="花田半亩" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/%E9%B2%B8%E9%B1%BC.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">文顶顶</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="https://www.cnblogs.com/wendingding/" target="_blank" class="nav-list-link">博客园</a></li><li class="nav-list-item"><a href="https://github.com/flowerField" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Gossip - Floating point addition</h1><div class="post-info">Apr 10, 2018<span class="post-count"></span> ✧ 字数统计:1.1k(字) &nbsp;&nbsp; ♨︎ 阅读时长:4(分钟)</div><div class="post-content"><div class='tip'>本文简单说明 JavaScript 中常见的进制转换函数以及浮点数计算的注意点。</div>

<p>如何把任意进制的数据转换为十进制？</p>
<p>假设我们有二进制数据<code>110</code>，如果要把该数据转换为十进制数据可以参考下面的处理过程。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">110</span>  = <span class="number">1</span> x <span class="number">2</span>^(<span class="number">2</span>) + <span class="number">1</span> x <span class="number">2</span>^(<span class="number">1</span>) + <span class="number">0</span> x <span class="number">2</span>^(<span class="number">0</span>) </span><br><span class="line">     = <span class="number">4</span>         + <span class="number">2</span>         + <span class="number">0</span> </span><br><span class="line">     = <span class="number">6</span></span><br></pre></td></tr></table></figure>

<p>在 JavaScript 语言中，我们可以通过 parseInt方法来处理上面的转换。</p>
<p><code>parseInt(string, radix)</code>函数将字符串转换为指定进制的整数，进制基数取值区间为<code>[2,36]</code>。</p>
<p>其中，函数的第一个参数为要被解析的值。如果参数不是一个字符串，那么会调用<code>toString()</code>来转换为字符串，此外字符串开头的空白符将会被忽略。第二个参数<code>radix</code>的取值范围从 2 到 36，代表该进位系统的数字。<code>parseInt</code>函数的返回值为从给定的字符串中解析出的一个整数，如果<code>radix</code>的取值超出<code>[2,36]</code>的范围或者第一个参数为非空格字符不能转换为数字，那么就返回 <code>NaN</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="string">&quot;110&quot;</span>, <span class="number">2</span>));</span><br><span class="line"><span class="comment">/* 计算过程： */</span></span><br><span class="line"><span class="comment">/* 110  = 1 x 2^(2) + 1 x 2^(1) + 0 x 2^(0)</span></span><br><span class="line"><span class="comment">        = 4         + 2         + 0</span></span><br><span class="line"><span class="comment">        = 6</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="string">&#x27;123&#x27;</span>, <span class="number">4</span>));</span><br><span class="line"><span class="comment">/* 计算过程 */</span></span><br><span class="line"><span class="comment">/* 123 = 3 x 4^(0) + 2 x 4^(1) + 1 x 4^(2) </span></span><br><span class="line"><span class="comment">       = 3         + 8         + 16</span></span><br><span class="line"><span class="comment">       = 27</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="string">&#x27;hello&#x27;</span>, <span class="number">2</span>));  <span class="comment">/* NaN */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="string">&#x27;&#x27;</span>, <span class="number">2</span>));       <span class="comment">/* NaN */</span></span><br></pre></td></tr></table></figure>

<div class="tip">ECMAScript 5 规范不再允许 parseInt 函数的实现环境把以0字符开始的字符串作为八进制数值。根据给定的 radix，parseInt函数产生一个由字符串参数内容解析过来的整数值。字符串中开头的空白会被忽略。如果radix没有指定或者为0，参数会被假定以10为基数来解析，如果数值以字符对0x或0X开头，会假定以16为基数来解析。</div>

<p><code>parseInt</code>函数在具体使用的时候有一些注意点，下面通过代码来简单展示这些注意点。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 问题: 为什么得到的结果为1 */</span></span><br><span class="line"><span class="comment">/* 注解：如果 parseInt 遇到的字符不是指定 radix 参数中的数字,</span></span><br><span class="line"><span class="comment">        它将忽略该字符以及所有后续字符，并返回到该点为止已解析的整数值。 */</span></span><br><span class="line"><span class="comment">/* 说明：字符串123abc中，从左向右解析，遇到2的时候解析就停止了 */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="string">&#x27;123abc&#x27;</span>, <span class="number">2</span>)); <span class="comment">/* 等价于parseInt(&#x27;1&#x27; , 2) ==&gt; 1*/</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="string">&#x27;123abc&#x27;</span>, <span class="number">3</span>)); <span class="comment">/* 等价于parseInt(&#x27;12&#x27;, 3) ==&gt; 5*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 如果没有指定转换的进制那么就默认以10进制的方式来处理 */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="string">&#x27;123abc&#x27;</span>)); <span class="comment">/* 123 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 如果第一个参数不是字符串那么会默认调用对应的 toString来转换 */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="number">101</span>, <span class="number">2</span>)); <span class="comment">/* 5 */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>([<span class="number">7</span>, <span class="number">2</span>, <span class="number">3</span>]));</span><br><span class="line"><span class="comment">/* 分析代码的处理过程 */</span></span><br><span class="line"><span class="comment">/* (1) [7,2,3]非字符串会默认转换为字符串,[7,2,3].toString() =&gt; &quot;7,2,3&quot; */</span></span><br><span class="line"><span class="comment">/* (2) parseInt(&quot;7,2,3&quot;,10) */</span></span><br><span class="line"><span class="comment">/* (3) parseInt(&quot;7&quot;,10) */</span></span><br><span class="line"><span class="comment">/* (4) 7 */</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>JavaScript 语言中的数据表示都是浮点型的，我们在进行转换的时候可能还需要考虑到小数的问题，而且 JavaScript 也是一门典型的<code>0.1 + 0.2 !== 0.3</code>的语言，下面简单通过代码来展示下这些问题。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log((<span class="number">6.625</span>).toString(<span class="number">2</span>))  <span class="comment">/* 110.101 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*110.101 =1 x 2^(2) +1 x 2^(1) +0 x 2^(0) +1 x 2^(-1) +0 x 2^(-2) +1 x 2^(-3)*/</span></span><br><span class="line"><span class="comment">/*        =4         +2         +0         +0.5        +0          +0.125     */</span></span><br><span class="line"><span class="comment">/*        =6.625 */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 浮点数字符串转换为二进制数据 */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">parseInt</span>(<span class="string">&quot;101.011&quot;</span>, <span class="number">2</span>)) <span class="comment">/* 5 说明：小数点后面的数会被截断*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 浮点数 */</span></span><br><span class="line"><span class="keyword">let</span> num = <span class="number">17.235</span>; <span class="comment">/* 整数部分：17  小数部分：0.235 */</span></span><br><span class="line"><span class="built_in">console</span>.log(num.toString(<span class="number">2</span>));</span><br><span class="line"><span class="comment">/* 结果：10001.0011110000101000111101011100001010001111010111 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 二进制表示 */</span></span><br><span class="line"><span class="built_in">console</span>.log((<span class="number">0.1</span>).toString(<span class="number">2</span>));</span><br><span class="line"><span class="comment">/* 结果：0.0001100110011001100110011001100110011001100110011001101 */</span></span><br><span class="line"><span class="built_in">console</span>.log((<span class="number">0.2</span>).toString(<span class="number">2</span>));</span><br><span class="line"><span class="comment">/* 结果：0.001100110011001100110011001100110011001100110011001101 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 执行按位相加操作 */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">0.1</span> + <span class="number">0.2</span>)          <span class="comment">/* 0.30000000000000004 */</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">0.1</span> + <span class="number">0.2</span> === <span class="number">0.3</span>)  <span class="comment">/* false */</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src='../../../../z.png' width="200px">

<ul>
<li>Posted by 博客园·<a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a> | <a target="_blank" rel="noopener" href="http://wendingding.com/">花田半亩</a></li>
<li>联系作者 简书·<a target="_blank" rel="noopener" href="http://www.jianshu.com/users/c5703017b9f5/latest_articleshttp://www.jianshu.com/users/c5703017b9f5/latest_articles">文顶顶</a> 新浪微博·<a href="http://weibo.com/p/1005053800117445/home?from=page_100505&mod=TAB#place">Coder_文顶顶</a></li>
<li>原创文章，版权声明：自由转载-非商用-非衍生-保持署名 | <a target="_blank" rel="noopener" href="http://www.cnblogs.com/wendingding/">文顶顶</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/2018/04/10/Gossip%20-%20Call%20by%20sharing/" class="prev">上一篇</a><a href="/2018/02/13/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0%20%5B006%5D-%E8%80%81%E4%BA%BA%E4%B8%8E%E6%B5%B7/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2022 <a href="https://weibo.com/u/3800117445">文顶顶</a> &nbsp;☁ 全站字数统计 418.8k (字)</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>